<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Tianyi Zhang" />

<meta name="date" content="2022-12-09" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Tianyi Zhang</h4>
<h4 class="date">2022-12-09</h4>



<div id="hw0-2022-09-09" class="section level1">
<h1>HW0-2022-09-09</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures,
tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>A dataset of an experiment on the cold tolerance of the grass plants,
by measuring the carbon dioxide uptake rate.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dataset1 <span class="ot">=</span> CO2</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataset1)</span></code></pre></div>
<pre><code>  Plant   Type  Treatment conc uptake
1   Qn1 Quebec nonchilled   95   16.0
2   Qn1 Quebec nonchilled  175   30.4
3   Qn1 Quebec nonchilled  250   34.8
4   Qn1 Quebec nonchilled  350   37.2
5   Qn1 Quebec nonchilled  500   35.3
6   Qn1 Quebec nonchilled  675   39.2</code></pre>
<p>Several plots summarize the data in the dataset CO2 and a regression
on it.</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">lm</span>(uptake <span class="sc">~</span> <span class="fu">log</span>(conc) <span class="sc">+</span> Type <span class="sc">+</span> Treatment, <span class="at">data =</span> dataset1))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>A piece of code which you can use to create a table in a LaTeX
file.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>xtable<span class="sc">::</span><span class="fu">xtable</span>(dataset1[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">22</span><span class="sc">:</span><span class="dv">28</span>), ])</span></code></pre></div>
<pre><code>% latex table generated in R 4.2.2 by xtable 1.8-4 package
% Fri Dec  9 13:28:00 2022
\begin{table}[ht]
\centering
\begin{tabular}{rlllrr}
  \hline
 &amp; Plant &amp; Type &amp; Treatment &amp; conc &amp; uptake \\ 
  \hline
1 &amp; Qn1 &amp; Quebec &amp; nonchilled &amp; 95.00 &amp; 16.00 \\ 
  2 &amp; Qn1 &amp; Quebec &amp; nonchilled &amp; 175.00 &amp; 30.40 \\ 
  3 &amp; Qn1 &amp; Quebec &amp; nonchilled &amp; 250.00 &amp; 34.80 \\ 
  4 &amp; Qn1 &amp; Quebec &amp; nonchilled &amp; 350.00 &amp; 37.20 \\ 
  5 &amp; Qn1 &amp; Quebec &amp; nonchilled &amp; 500.00 &amp; 35.30 \\ 
  6 &amp; Qn1 &amp; Quebec &amp; nonchilled &amp; 675.00 &amp; 39.20 \\ 
  7 &amp; Qn1 &amp; Quebec &amp; nonchilled &amp; 1000.00 &amp; 39.70 \\ 
  22 &amp; Qc1 &amp; Quebec &amp; chilled &amp; 95.00 &amp; 14.20 \\ 
  23 &amp; Qc1 &amp; Quebec &amp; chilled &amp; 175.00 &amp; 24.10 \\ 
  24 &amp; Qc1 &amp; Quebec &amp; chilled &amp; 250.00 &amp; 30.30 \\ 
  25 &amp; Qc1 &amp; Quebec &amp; chilled &amp; 350.00 &amp; 34.60 \\ 
  26 &amp; Qc1 &amp; Quebec &amp; chilled &amp; 500.00 &amp; 32.50 \\ 
  27 &amp; Qc1 &amp; Quebec &amp; chilled &amp; 675.00 &amp; 35.40 \\ 
  28 &amp; Qc1 &amp; Quebec &amp; chilled &amp; 1000.00 &amp; 38.70 \\ 
   \hline
\end{tabular}
\end{table}</code></pre>
</div>
</div>
<div id="hw1-2022-09-15" class="section level1">
<h1>HW1-2022-09-15</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>(Exercise 3.3, Statistical Computating with R)</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>Let <span class="math inline">\(U = F(x)\)</span>, it’s easy to get
the inverse transformation of <span class="math inline">\(F(x)\)</span>
<span class="math display">\[x = F^{-1}(U) = b(1-U)^{-\frac{1}{a}}, x ≥
b &gt; 0,a &gt; 0.\]</span> Now we generate 1000 samples from the
Pareto(2, 2) distribution by using the inverse transform method.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>U_3 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>sample_3 <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>U_3) <span class="sc">^</span> (<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<p>Finally we graph the density histogram of the sample with the
Pareto(2, 2) density.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_3, <span class="at">prob =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="at">breaks =</span> <span class="dv">140</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Histogram of Samples From Pareto(2,2)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;density&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2</span>, <span class="at">to =</span> <span class="dv">25</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="at">y =</span> <span class="dv">8</span> <span class="sc">/</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2</span>, <span class="at">to =</span> <span class="dv">25</span>, <span class="at">by =</span> <span class="fl">0.1</span>) <span class="sc">^</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>(There are few and scattered samples much bigger than 20. For
readability, we don’t show them in the plot above.)</p>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>(Exercise 3.7, Statistical Computating with R)</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>The pdf of Beta(<span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>) distribution tends to infinity as
<span class="math inline">\(x\)</span> tends to 0 while <span class="math inline">\(a\)</span> is no bigger than 1, or as <span class="math inline">\(x\)</span> tends to 1 while <span class="math inline">\(b\)</span> is no bigger than 1. I cannot find a
pdf to cover it, so I only discuss the situation where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are both bigger than 1. First, we write
the function that generates a random sample of size n from the
Beta(<span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>) distribution by the
acceptance-rejection method. According to the AM-GM inequality, <span class="math display">\[x^{a-1}(1-x)^{b-1}\leq
[\frac{(a-1)x+(b-1)(1-x)}{a+b-2}]^{\frac{1}{a+b-2}}\leq[\frac{max(a-1,
b-1)}{a+b-2}]^{\frac{1}{a+b-2}}, a&gt;1,b&gt;1.\]</span> Therefore, we
set <span class="math inline">\(g \sim U(0,1)\)</span> and <span class="math inline">\(c = Beta(a, b)[\frac{max(a-1,
b-1)}{a+b-2}]^{-\frac{1}{a+b-2}}\)</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>beta_7 <span class="ot">=</span> <span class="cf">function</span>(n, a, b)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  count1 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  count2 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(count2 <span class="sc">&lt;</span> n)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    count1 <span class="ot">=</span> count1 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(u <span class="sc">&lt;</span> y <span class="sc">^</span> (a<span class="dv">-1</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>y) <span class="sc">^</span> (b<span class="dv">-1</span>) <span class="sc">*</span> (<span class="fu">max</span>(a<span class="dv">-1</span>, b<span class="dv">-1</span>) <span class="sc">/</span> (a<span class="sc">+</span>b<span class="dv">-2</span>)) <span class="sc">^</span> (<span class="dv">1</span> <span class="sc">/</span> (a<span class="sc">+</span>b<span class="dv">-2</span>)))</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">=</span> <span class="fu">c</span>(x, y)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>      count2 <span class="ot">=</span> count2 <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(x, count1, count2))</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we use the function to generate 1000 samples from Beta(3, 2)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">514</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sample_7 <span class="ot">=</span> <span class="fu">beta_7</span>(<span class="dv">1000</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>sample_7[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>[1] 14212</code></pre>
<p>This how many iterations have occured in the process above. Finally
we graph the density histogram of the sample with the Beta(3, 2)
density.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_7[[<span class="dv">1</span>]], <span class="at">prob =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="dv">50</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Histogram of Samples From Beta(3,2)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;density&quot;</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>), <span class="at">y =</span> <span class="dv">12</span> <span class="sc">*</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>) <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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pyZP2H14BKVlulpAg9+S+WoBDX1L5usFlMkoAUr7nQARoLTfCdCrB3RJIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERIKCcgI7u44eO8FlEvcnr6EcceMn5qxozPFi0zgqIPxfFPBvF24hPzrfj1vB7yfnjEbI8ejUnIDkppF7L4W3EJ6/VUx1H534dmXtY+QB9uhGPtpAzit5GfHL+aftDDCAveaGA/sTjW025ehvxycVmVB3kJy+yiMkKQFUD3kZ8clFiogC1MoxvIkIqFBB6oiNIzp/P/+kmyx0oZRYxsTG+iMXXgGGVWUnv1Z0qw2sRL3l8/IZVbDMfGUFeckkr7WFjWuV2FCN70l7yIusgUTC4h7IXso9uR7zkdfRQw0vOX6yb5y5BGqwCESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiodEL9nLPEV72kqHZB+R/diKh1QfXzzn6/z3NA7TsUDqiuW5Y75sSofUKY75seqeECn3V8XfWpj8YD22//tlnxoY+mA+KMJ89zwPFKlA+L3Apsbg5dQ6YAWFwECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgP4PczvGAJ1nUhkAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>(Exercise 3.12, Statistical Computating with R)</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1919</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>lambda_12 <span class="ot">=</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">rate =</span> <span class="dv">2</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>sample_12 <span class="ot">=</span> <span class="fu">rexp</span>(<span class="dv">1000</span>, lambda_12)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sample_12)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.00025 0.14981 0.38514 0.65862 0.88013 8.88801 </code></pre>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>(Exercise 3.13, Statistical Computating with R)</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>We are informed that the samples in Exercise 3.12 come from the
Pareto(4,2) distribution. Now we use the samples to graph the density
histogram with the Pareto(4,2) theoretical density. (Noticed the
difference between the two formulas in Exercise 3.3 and Exercise 3.13,
we should add 2 to each sample before we graph the histogram.)</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_12<span class="sc">+</span><span class="dv">2</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>), <span class="at">breaks =</span> <span class="dv">50</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Histogram of Samples From Pareto(4,2)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;density&quot;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="at">y =</span> <span class="dv">64</span> <span class="sc">/</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">2</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>) <span class="sc">^</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw2-2022-09-23" class="section level1">
<h1>HW2-2022-09-23</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>i). For <span class="math inline">\(n = 10^4, 2 × 10^4, 4 × 10^4, 6 ×
10^4, 8 × 10^4\)</span>, apply the fast sorting algorithm to randomly
permuted numbers of <span class="math inline">\(1, . . . ,
n\)</span>.</p>
<p>ii). Calculate computation time averaged over <span class="math inline">\(100\)</span> simulations, denoted by <span class="math inline">\(a_n\)</span>.</p>
<p>iii). Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n := n log(n)\)</span>, and graphically show the
results (scatter plot and regression line).</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>Firstly, we write a function of the fast sorting algorithm named
quicksort.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>quicksort <span class="ot">=</span> <span class="cf">function</span>(x, <span class="at">count =</span> <span class="dv">0</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>) <span class="fu">return</span>(<span class="fu">list</span>(x, count))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  xi <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x), <span class="dv">1</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  flag <span class="ot">=</span> x[xi]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">=</span> x[<span class="sc">-</span>xi]</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  indexs <span class="ot">=</span> <span class="fu">which</span>(temp <span class="sc">&lt;=</span> flag)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">=</span> count <span class="sc">+</span> <span class="fu">length</span>(indexs)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">=</span> <span class="fu">quicksort</span>(temp[indexs], count)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">=</span> x1[[<span class="dv">2</span>]]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">=</span> x1[[<span class="dv">1</span>]]</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  indexb <span class="ot">=</span> <span class="fu">which</span>(temp <span class="sc">&gt;</span> flag)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">=</span> count <span class="sc">+</span> <span class="fu">length</span>(indexb)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">=</span> <span class="fu">quicksort</span>(temp[indexb], count)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">=</span> x2[[<span class="dv">2</span>]]</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">=</span> x2[[<span class="dv">1</span>]]</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(x1, flag, x2), count))</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>i).</p>
<p>Now we apply our function to samples of randomly permuted numbers of
<span class="math inline">\(1, . . . , n, n = 10^4, 2 × 10^4, 4 × 10^4,
6 × 10^4, 8 × 10^4\)</span>. The codes when <span class="math inline">\(n = 10^4\)</span> are shown below, and the others
are concealed.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sample1_1 <span class="ot">=</span> <span class="fu">quicksort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>))[[<span class="dv">1</span>]]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="at">y =</span> sample1_1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="at">yaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;1:10000&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;fast-sorted-sample&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Fast Sort Randomly Permuted Data of 1 to 10000&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAArlBMVEUAAAAAACsAAFUAKysAK1UAK4AAVYAAVaorAAArACsrAFUrKwArKysrK1UrVYArVaorgKorgNRVAABVACtVKwBVKytVgKpVgNRVqtRVqv+AKwCAVQCAVSuAgKqAqoCAqtSA1NSA1P+qVQCqVSuqVYCqgCuqgFWq1Kqq1P+q/9Sq///UgCvUgFXUqlXUqoDU1KrU1NTU/6rU/9TU////qlX/1ID/1Kr//6r//9T///+3PJlKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALsklEQVR4nO2di3bcNBCGnTRhU0pbNgTaDYWSLaUhCw0QJ1m//4uhm21pffntsSTLyfzntHEdXT9L8lgaqVnB6lU2dwFSFwMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgFoB7X+/MReXmdLR62uY0jY7vukNIBI7vWvc3ekcsgE59JW0qywm+aM3jeQ7oloBPp1l2ds2QA8XxweARA5XqKwTAQ3Ioa+kXWWpk98Mi1orl9HWbYDq5GtA2QoVdiqgtl9S82wBdPgAYHFFVBklK77+mGUvfrrTd369yI4vZHI6dlmn+zP186v81esrHfS3T1l2ojKVbfHko8mxSu7xPFt9fZUdvS/+OlMBZWL/XWrS4ulsymKoaA/nqjh7kejRW6swXw5TMTUTqa/FpS5pHcstS5387YV+xFUNyqh1lYyq8m811WxXPz59efpzE5AILX7m9aPYWY+lamYyTp2cqILWq7IaMjFT4EYN9PMycU6qhE7/PUylBZAVyymLnbwI49TARLWq5LQ4EbYEpNqGuL1Wvzy9Lv5xu1jdgsQ/vrmTlzroybWJJjJZ3cmHKGLd18nJYq+Lv0Uu7/UNlZgIsNGtq3BqcHsuf4qcr+scZGEaqdiAzLUVyy6LA0hd2DXYmmdW3VC6d3CoLmY90Z1p961jkE7i9o9Xqq3qoCK5lVViXcMyOf3M9N+qCArQXvWxuoc5Y5Cuta6UKUwjlSYgO5ZdlkNAupmUNagqWd4orKobHBrQ6V0ZvUyjDdBKhNp/qMZrHVQ1hL0ZVrb6EVXJ6Vai/64BlfWoRmT7LSaCVdemMI1UmoCsWHZZ2gBZNdBBrBt2j7FwZNag2Q3o5KP5x8kvt+cHgMruYlpNlVwHINnHzDO3ASlDJc8GA7KurVh2WVoA2TUou1h1oyjqrm/hgC1I9IrPOpAu0+MhoJL6wBYkH3KZkVMDPQJs6vtDAVmx7LK4yYvfHN/YNSijru0RsbUFHXa6BiD1lKuBoxxCK0A9Y1AbIBn1lWXz2ICssbsbkP5FntljUBWrawx6uJRVsGtQNr7qhhXfGYMaw3b9034iIiE1wuucHED6zbFteYu1AlJDRtXDHEAiH2HwPJzrNDoBib9lMaoSW7Hsspjk3THOrYF9o2zDh28xxw7SYPKsxVBU/adtkDYmVdZiB7UCkslYTBxAxqLRllYHoGpMXpcltWI5ZXEAyU8NuwYq6p/WDSd8jcNY0u/sliPtiJNrG5DMd6WG/JOPu7r5GUD7z2fZi/e2Jf2urWplYrnz3eIAKh4+iOqrD8tOQMW9MH7ffFHjvClpHcstS11h87Fq1UBHtW4YHeKYYbrDMoIWoPiAHi7gZ2JKig1IjRdrHC4ZzQDo6PvIeU4ST7kCMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgRkAVI+JtslTajHUA0oP7raSRcdJuSoArS/XBc7uS69pEWrCKoAPZ5vFKCcATlqtKAtwRv3KetwDNotad08hty3GM3f/UmL7SAgP4Cy5SkuoFDJhdJoQNW2gSyb5ryzDEACD7egbqnmw4A6pXsXBZDqZxPNxOQBlaMPAVCuTKDdNEModUDV4Dwe0P5yo35O+9RIG5D18hoP6PEH3XSmfawmDch+t9Nb0O6ptiDX9qGMQeozdeLHarqADkxDQhfzYiumCqhhOrMd5Kj5ZcGALLV9eREAlX3syb3FWj9MKW8xH3Ot6QHq+HCnDNIbH8XxkIZPdc5rUFqQjwWxxAB1T/sQxqD7lx6mo5MC1DctRgF09sQG6d5ZQ0oXgwfgjEludoFZ1Wc/SKNJ52c+SONJ+ec9SA9Ys5jwsbr4QXrQms4z/hYbtuT1bAENXRJ8rh+rg1dMCYC2p3e7lTAXNyPLpFIZveQdRCGW3K1Bel3k0gVvuXPSYx4PzVC8//ZG/aFrRkDjmi/NUJRLP0sFNLJ3E/qidG/drhfaxUaPfpTBaruyD/+iaSZA418Oz8oOorw8AwEqDwHrbGZzACLZFiRDca0OUO0Zgnbl0Uh51xlJ8QERbS+aoXh/tpIjUZesGZGuoTw6IKppSrOD5PJ8j3eHNafWFSoyILrpTgO0lQcAdgNKrgVN+LKhdLHV47ncDtUzNV25fiQxBk368qN9zcvzcnun7ssv/s6RPCKgaR/GT94OmjpxQAM0feI+FqDJ8yqBACViKHqYdwoDKA1D0cu0XBBAabzm/cxaBgGUgqHoa1Y3yFssgRbkbdJ7JKCBLq5zG4oeFwUILUhXOu/dqzGvoehzzYTu/pLslKvfNSW6+0uqezU8L7nR3V96d/vMZih6X5IkjUGbAuwXm81Q9L9iS3nNwx2Hc73mQ6xoB7GDug3FoGvzYRL1HrCYqQUFcoggdjFwAtUMhmIofxHKID3gBKrYhmI4fxraa376CVSejZWAZtXogH5OoPJq7IZ0x6K3oGQMxbDeauQxqHdTb0RDMbQ3H9lQ7DOkI77mgzs7RjYUScl1K4IzKGGQxicvxGpBMXxl6YD6XvNRDMU4vsRjAW3rr6mZDcVIrtb0FhQp3674sVzR6RNmkfLtiB5vbX90wAR2HMbcyUAxFH2ccjulhlE3elBaEFwXG7B6Rq9j5I0wYfyD9peolVErGX2fUBhAeO84sZrxt1FRAKmTBcAheDk4oIpU0Tm2mZGXnmc4omuWXXh0Oyj20vNMuxQXs/Q81ybOhbSg+Ta5LmMMmnEPcKi3mLd8izmbTxHMDvKZ3LxbyCMDGr82P/sW+/EBB2yo85fvzHhIgPCGOm/5zt18CqodBDbU+cp3fjxUQGBDnZ98E2g+Ba2L4Q11PvJNAg9xkMYb6ibnm0bzKZK1g1LBQwUUeENdMs2nSBNQQnhSBJRS8ykSBJQWnuQAJdZ8ikDuL+R8k8MTyv2Flm96zacI5v5CyTdFPAm5vyTZfIp0LOlE8aQyYZZq8ynSmDBLGE8SE2Yp40lgwizp5lPMP2GWOJ65J8xSbz7FzK/59PEEAzRkO9QCmk9B7WL4cBO8HWoReKh2EDiyfchmloXwIb3m4ZHtQ/bNL0YEQPDIdq/bocb4gcwZsgo45Mh2n9uhFgdo0JHtHrdDLQ9Q5CPbFwjIh54qIDFCx95QtzRAawbUG3BXGwiRHMkXBij+ntXFAWK1iwEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIB8Asp79gTr2eyVHap5MU56eSFAwo48ApL/oULnf6pw//LqIFTzYpwez9XMlf+EXfkDpFfNuhzUypXGKlTzYpxyM7XnPeED+QOkF627/K92q4NQzYtRueXZWqPxnfChPAJSbb3Lg2/7XaZcsKtQzYuxGeooARJ25A+Q7u0dfV46rxVyXbIK1bwYnaGseoiEHUUCZIIc3/gGFCJhR7G6mA5ytvHexQIk7CjWIK2DvLzyOJbagLwm7CjSa14XVlTJ49tYAQqRsKNYhqIqp/w/KfzZc+Yt5j9hRz4/NXZ9lr3ccLVxQjUvxsl0Mf8JO+KPVSAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBICVJ8aos5xUqeD9Lj2+vDxHaB0ABm33kLyETXfSd/nHo8NL64bA5QMoLzesV95PvX4/Phx/hmgVACVbr31MXyiefR4jflxHxugVAAVDW/CbZu7oWcHxAFKFpA8w6nHc9WPC+sApQooL8doBlTJBqTPAOMu5siqrTmwkQdpRzWg8jA5fs07yms7qDxjjw1FW5UdZE57krXvce314eM7QAkBSlMMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwL6H3jY+IhCHuWuAAAAAElFTkSuQmCC" /><!-- --></p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>ii).</p>
<p>We write another function to calculate average computation time.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>timing <span class="ot">=</span> <span class="cf">function</span>(n, <span class="at">times =</span> <span class="dv">100</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>times)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">=</span> <span class="fu">c</span>(t, <span class="fu">system.time</span>(<span class="fu">quicksort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)))[<span class="dv">1</span>])</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(t))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we apply this function to situations where <span class="math inline">\(n = 10^4, 2 × 10^4, 4 × 10^4, 6 × 10^4, 8 ×
10^4\)</span>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>a_n <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">timing</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">timing</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>),<span class="fu">timing</span>(<span class="dv">4</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">timing</span>(<span class="dv">6</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">timing</span>(<span class="dv">8</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>a_n</span></code></pre></div>
<pre><code>[1] 0.0807 0.1588 0.2871 0.4381 0.7502</code></pre>
<p>iii).</p>
<p>We regress <span class="math inline">\(a_n\)</span> from question
above on <span class="math inline">\(t_n := n log(n)\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>t_n <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>), <span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>), <span class="dv">4</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">4</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>), <span class="dv">6</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">6</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>), <span class="dv">8</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="sc">*</span><span class="fu">log</span>(<span class="dv">8</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>fit1_3 <span class="ot">=</span> <span class="fu">lm</span>(a_n <span class="sc">~</span> t_n)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1_3)</span></code></pre></div>
<pre><code>
Call:
lm(formula = a_n ~ t_n)

Residuals:
       1        2        3        4        5 
 0.02263  0.01764 -0.03110 -0.06535  0.05618 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) -1.414e-02  4.536e-02  -0.312  0.77564   
t_n          7.841e-07  8.341e-08   9.401  0.00255 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.05543 on 3 degrees of freedom
Multiple R-squared:  0.9672,    Adjusted R-squared:  0.9562 
F-statistic: 88.37 on 1 and 3 DF,  p-value: 0.00255</code></pre>
<p>The t-test on the regression strongly approves that <span class="math inline">\(a_n \sim O(nlog(n))\)</span>.</p>
<p>Finally we graph a scatter plot and regression line to reveal the
conclusion.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> t_n, <span class="at">y =</span> a_n, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">&quot;t&quot;</span>[<span class="st">&quot;n&quot;</span>] <span class="sc">*</span> <span class="st">&quot;=O(nlog(n))&quot;</span>), <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">&quot;a&quot;</span>[<span class="st">&quot;n&quot;</span>]), <span class="at">main =</span> <span class="st">&quot;Averaged Computation Time in the Fast Sort Algorithm </span><span class="sc">\n</span><span class="st"> on Different Size of Samples&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> t_n, <span class="at">y =</span> <span class="fu">predict</span>(fit1_3))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>(Exercise 5.6, Statistical Computating with R)</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>Suppose samples <span class="math inline">\(U_1, U_2, ..., U_{2m}
\sim U(0,1)\)</span> are independent identically distributed(i.i.d.),
and the simple Monte Carlo estimate of <span class="math inline">\(\hat\theta\)</span> will be <span class="math inline">\(\hat\theta_{MC} := \frac{1}{2m}
\sum\limits_{i=1}^{2m} e^{U_i}\)</span>. If we use antithetic variables,
the estimate will be <span class="math inline">\(\hat\theta_{MCa} :=
\frac{1}{2m} \sum_\limits{i=1}^{m} (e^{U_i} + e^{1-U_i})\)</span>.</p>
<p>Because <span class="math display">\[E(e^U) = \int_0^1 e^u du =
e-1,\]</span> and <span class="math display">\[E(e^{1-U}) = \int_0^1
e^{1-u} du = e-1,\]</span> we can compute that <span class="math display">\[Cov(e^U, e^{1-U}) = E(e^U
e^{1-U})-E(e^U)E(e^{1-U}) = e - (e-1)^2 &lt; 0.\]</span></p>
<p>Therefore the use of antithetic variate can reduce the variance of
<span class="math inline">\(\hat\theta\)</span>.</p>
<p>Because <span class="math display">\[Var(e^U) = E(e^{2U}) -
[E(e^U)]^2 = \int_0^1 e^{2u} du - [E(e^U)]^2 = \frac{1}{2} (e^2-1) -
(e-1)^2 = -\frac{1}{2}e^2 + 2e - \frac{3}{2},\]</span> and <span class="math display">\[Var(e^{1-U}) = E(e^{2(1-U)}) - [E(e^{1-U}]^2 =
\int_0^1 e^{2(1-u)} du - [E(e^{1-U})]^2 = \frac{1}{2} (e^2-1) - (e-1)^2
= -\frac{1}{2}e^2 + 2e - \frac{3}{2},\]</span> we can compute that <span class="math display">\[Var(e^U+e^{1-U}) = Var(e^U) + Var(e^{1-U}) +
2Cov(e^U, e^{1-U}) = -e^2 + 4e - 3 + 2e - 2(e-1)^2 = -3e^2 + 10e -
5.\]</span></p>
<p>Thus, <span class="math display">\[Var(\hat\theta_{MCa}) =
\frac{1}{4m^2}\sum\limits_{i=1}^{m} Var(e^{U_i} + e^{1-U_i}) =
\frac{-3e^2 + 10e - 5}{4m},\]</span> and <span class="math display">\[Var(\hat\theta_{MC}) =
\frac{1}{4m^2}\sum\limits_{i=1}^{2m} Var(e^{U_i}) =
\frac{-\frac{1}{2}e^2 + 2e - \frac{3}{2}}{2m},\]</span></p>
<p>Above all, the percent reduction in variance of <span class="math inline">\(\hat\theta\)</span> that can be achieved using
antithetic variate is <span class="math display">\[1 -
\frac{Var(\hat\theta_{MCa})}{Var(\hat\theta_{MC})} = 1 - \frac{-3e^2 +
10e - 5}{-e^2 + 4e - 3} = \frac{2e^2 - 6e + 2 }{-e^2 + 4e - 3},\]</span>
which is:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">2</span>) <span class="sc">-</span> <span class="dv">6</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">1</span>) <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="sc">-</span><span class="fu">exp</span>(<span class="dv">2</span>) <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>[1] 0.9676701</code></pre>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>(Exercise 5.7, Statistical Computating with R)</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>According the formulas in Exercise 5.6, we code empirical estimates
of the percent reduction in variance using the simple MC and the
antithetic variate.(We set <span class="math inline">\(m=1000\)</span>
and do <span class="math inline">\(1000\)</span> times Monte Carlo
estimates.)</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>theta_MC <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>theta_MCa <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  sample5_7 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">2000</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  theta_MC <span class="ot">=</span> <span class="fu">c</span>(theta_MC, <span class="fu">mean</span>(<span class="fu">exp</span>(sample5_7)))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  theta_MCa <span class="ot">=</span> <span class="fu">c</span>(theta_MCa, <span class="fu">mean</span>(<span class="fu">c</span>(<span class="fu">exp</span>(sample5_7[<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>]), <span class="fu">exp</span>(<span class="dv">1</span> <span class="sc">-</span> sample5_7[<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>]))))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here is the density plot of two kinds estimates of <span class="math inline">\(\hat\theta\)</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(theta_MCa), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.68</span>, <span class="fl">1.76</span>),</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Estimate of θ&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Distributions of Estimates Using Two Monte Carlo Methods&quot;</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(theta_MC), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Simple MC&quot;</span>, <span class="st">&quot;Antithetic Variate&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">exp</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Following are the estimate of standard deviation of <span class="math inline">\(\hat\theta_{MC}\)</span> using the simple MC
method, and the estimate of standard deviation of <span class="math inline">\(\hat\theta_{MCa}\)</span> using the antithetic
variate, and the ratio of <span class="math inline">\(\hat{sd}(\hat\theta_{MCa})\)</span> and <span class="math inline">\(\hat{sd}(\hat\theta_{MC})\)</span>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sd</span>(theta_MC), <span class="fu">sd</span>(theta_MCa), <span class="fu">sd</span>(theta_MCa) <span class="sc">/</span> <span class="fu">sd</span>(theta_MC))</span></code></pre></div>
<pre><code>[1] 0.011058379 0.002011831 0.181928157</code></pre>
<p>The empirical estimate of percent reduction in variance using the
antithetic variate is:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> (<span class="fu">sd</span>(theta_MCa) <span class="sc">/</span> <span class="fu">sd</span>(theta_MC)) <span class="sc">^</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>[1] 0.9669021</code></pre>
<p>And the theoretical value from Exercise 5.6 is:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">2</span>) <span class="sc">-</span> <span class="dv">6</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">1</span>) <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="sc">-</span><span class="fu">exp</span>(<span class="dv">2</span>) <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>[1] 0.9676701</code></pre>
</div>
</div>
<div id="hw3-2022-09-30" class="section level1">
<h1>HW3-2022-09-30</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>(Exercise 5.13, Statistical Computating with R)</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>Firstly, we graph the function image of <span class="math inline">\(g(x)\)</span>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">y =</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">ylab =</span> <span class="st">&quot;value of function&quot;</span>, <span class="at">main =</span> <span class="st">&quot;g(x)&quot;</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="at">yaxs =</span> <span class="st">&quot;i&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The form of <span class="math inline">\(g\)</span> seems similar to
the pdf of normal distribution, so we choose the pdf of <span class="math inline">\(X_1 := \left| X \right| + 1 , X \sim N(0,
1)\)</span> as <span class="math inline">\(f_1\)</span> in order to
‘close’ <span class="math inline">\(g\)</span>. Now we generate the pdf
of <span class="math inline">\(f_1\)</span>.</p>
<p>For <span class="math inline">\(\forall x&gt;1\)</span>, there is
<span class="math display">\[ P(X_1 &lt; x) = P(\left| X \right| + 1
&lt; x) = P(1-x &lt; X &lt; x-1) = 1 - 2 \Phi(1-x), \]</span> where
<span class="math inline">\(\Phi\)</span> is the cdf of <span class="math inline">\(N(0, 1)\)</span>.</p>
<p>Thus, we generate that <span class="math display">\[ f_1 (x) = 2 \Phi
^ \prime (t)|_{t = 1 - x} = \frac{2}{\sqrt{2 \pi}} e^{-\frac{(1-x) ^
2}{2}}, x &gt; 1\]</span></p>
<p>Another good idea to ‘close’ <span class="math inline">\(g\)</span>
is let <span class="math inline">\(X_2 := Y + 1, Y \sim \Gamma(2,
2).\)</span> It is easy to generate that <span class="math inline">\(f_2\)</span>, the pdf of <span class="math inline">\(X_2\)</span>, is <span class="math display">\[
f_2(x) = \frac{2^2}{\Gamma(2)} (x-1) e^{-2(x-1)}, x &gt; 1.\]</span></p>
<p>In an R program, both <span class="math inline">\(X \sim N(0,
1)\)</span> and <span class="math inline">\(Y \sim \Gamma(2, 2)\)</span>
can be easily ganerated by the function rnorm() and rgamma(), so <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are both easy to approach.</p>
<p>Now we add the two function images of <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> to the graph above. (Because <span class="math inline">\(\int^{\infty}_1 g dx \approx 0.4\)</span> and
<span class="math inline">\(\int^{\infty}_1 f_1 dx = \int^{\infty}_1 f_2
dx = 1\)</span>, we use the image of <span class="math inline">\(2.5g\)</span> instead of the image of <span class="math inline">\(g\)</span>.)</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fl">2.5</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylab =</span> <span class="st">&quot;value of function&quot;</span>, <span class="at">main =</span> <span class="st">&quot;(2.5)g(x) and It&#39;s &#39;Close&#39;&quot;</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="at">yaxs =</span> <span class="st">&quot;i&quot;</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">gamma</span>(<span class="dv">2</span>) <span class="sc">*</span> (x<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (x<span class="dv">-1</span>)), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="co">#or dgamma(x-1, 2, 2)</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;2.5g(x)&quot;</span>, <span class="fu">expression</span>(<span class="st">&quot;f&quot;</span>[<span class="dv">1</span>]<span class="sc">*</span><span class="st">&quot;(x)&quot;</span>), <span class="fu">expression</span>(<span class="st">&quot;f&quot;</span>[<span class="dv">2</span>]<span class="sc">*</span><span class="st">&quot;(x)&quot;</span>)), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">lty =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Next we use the importance sampling method to estimate <span class="math display">\[\theta = \int^{\infty}_{1}
\frac{x^2}{\sqrt{2\pi}} e^{−x^2/2} dx.\]</span></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>g13 <span class="ot">=</span> <span class="cf">function</span>(x)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>f113 <span class="ot">=</span> <span class="cf">function</span>(x)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>f213 <span class="ot">=</span> <span class="cf">function</span>(x)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">4</span> <span class="sc">/</span> <span class="fu">gamma</span>(<span class="dv">2</span>) <span class="sc">*</span> (x<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (x<span class="dv">-1</span>)))</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>m13 <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>sample13_1 <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(m13)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>grf13_1 <span class="ot">=</span> <span class="fu">numeric</span>(m13)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m13)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  grf13_1[i] <span class="ot">=</span> <span class="fu">g13</span>(sample13_1[i]) <span class="sc">/</span> <span class="fu">f113</span>(sample13_1[i])</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>sample13_2 <span class="ot">=</span> <span class="fu">rgamma</span>(m13, <span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>grf13_2 <span class="ot">=</span> <span class="fu">numeric</span>(m13)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m13)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  grf13_2[i] <span class="ot">=</span> <span class="fu">g13</span>(sample13_2[i]) <span class="sc">/</span> <span class="fu">f213</span>(sample13_2[i])</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(grf13_1), <span class="fu">mean</span>(grf13_2))</span></code></pre></div>
<pre><code>[1] 0.4007598 0.4016591</code></pre>
<p>Contrasted with the theoretical value:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(g13, <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="st">&quot;infinity&quot;</span>)</span></code></pre></div>
<pre><code>0.400626 with absolute error &lt; 5.7e-07</code></pre>
<p>The variance of <span class="math inline">\(\hat\theta\)</span>
(<span class="math inline">\({Var} (\hat\theta)\)</span>) of the
improtance function <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> are seperately:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">var</span>(grf13_1), <span class="fu">var</span>(grf13_2))</span></code></pre></div>
<pre><code>[1] 0.001922387 0.087638241</code></pre>
<p>We can infer that the FIRST importance function produce the smaller
variance.</p>
<p>Let us back to the theoritical variance of <span class="math inline">\(\hat\theta\)</span> (<span class="math inline">\(Var (\hat\theta)\)</span>), which is <span class="math display">\[ \frac{1}{m} Var(\frac{g(X)}{f(X)}), \]</span>
where <span class="math inline">\(X \sim f\)</span>.</p>
<p>Because we use the same <span class="math inline">\(m\)</span> in
both <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span>, and <span class="math display">\[E(\frac{g(X)}{f(X)}) = \int^{\infty}_1
\frac{g(x)}{f(x)} \cdot f(x) dx = \int^{\infty}_1 g(x) dx,\]</span></p>
<p>which implies <span class="math inline">\(E(g(X) / f(X))\)</span>
does not depend on the choose of <span class="math inline">\(f\)</span>,
the problem comes into the comparasion between <span class="math display">\[E(\frac{g^2 (x)}{f^2_i (x)}), i = 1,
2.\]</span></p>
<p>Because <span class="math display">\[E(\frac{g^2 (x)}{f^2_1 (x)}) =
\int^{\infty}_1 \frac{g^2 (x)}{f_1 (x)} dx = \int^{\infty}_1
\frac{x^4}{4\sqrt{2\pi}} e^{−x^2 + \frac{(1-x)^2}{2}} dx,\]</span></p>
<p>and <span class="math display">\[E(\frac{g^2 (x)}{f^2_2 (x)}) =
\int^{\infty}_1 \frac{g^2 (x)}{f_2 (x)} dx = \int^{\infty}_1
\frac{x^4}{2\pi \cdot 4(x-1)} e^{−x^2 + 2(x-1)} dx,\]</span></p>
<p>with the help of computer,</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">integrate</span>(<span class="cf">function</span>(x) {<span class="fu">return</span>(x<span class="sc">^</span><span class="dv">4</span> <span class="sc">/</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>))}, <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="st">&quot;infinite&quot;</span>)<span class="sc">$</span>value,</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">integrate</span>(<span class="cf">function</span>(x) {<span class="fu">return</span>(x<span class="sc">^</span><span class="dv">4</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">/</span> <span class="dv">4</span> <span class="sc">/</span> (x<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> (x<span class="dv">-1</span>)))}, <span class="at">lower =</span> <span class="fl">1.01</span>, <span class="at">upper =</span> <span class="st">&quot;infinite&quot;</span>)<span class="sc">$</span>value)</span></code></pre></div>
<pre><code>[1] 0.08122181 0.19165810</code></pre>
<p>we finally get <span class="math display">\[E(\frac{g^2 (x)}{f^2_1
(x)}) = \int^{\infty}_1 \frac{x^4}{4\sqrt{2\pi}} e^{−x^2 +
\frac{(1-x)^2}{2}} dx &lt; \int^{\infty}_{1.01} \frac{x^4}{2\pi \cdot
4(x-1)} e^{−x^2 + 2(x-1)} dx &lt; \int^{\infty}_1 \frac{x^4}{2\pi \cdot
4(x-1)} e^{−x^2 + 2(x-1)} dx = E(\frac{g^2 (x)}{f^2_2
(x)}).\]</span></p>
<p>This is consistant with our conclusion that the FIRST importance
function produce the smaller variance from the empirical simulation
above.</p>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>(Exercise 5.15, Statistical Computating with R)</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>In Example 5.13, the function to be integrated is <span class="math inline">\(g(x) = e ^ {-x} / (1 + x^2), 0 &lt; x &lt;
1\)</span> and the importance function is <span class="math inline">\(f(x) = e ^ {-x} / (1 - e ^ {-1}), 0 &lt; x &lt;
1\)</span>. Then the stratified importance sampleing method divides the
interval <span class="math inline">\((0, 1)\)</span> into five
subintervals, which are <span class="math inline">\((j/5,(j + 1)/5), j =
0, 1,..., 4.\)</span></p>
<p>Thus on the <span class="math inline">\(j^{th}\)</span> subinterval
variables <span class="math inline">\(X_j\)</span> are generated from
the density owning the form like <span class="math inline">\(f(x) = e ^
{-x} / (1 - e ^ {-1}), j/5 &lt; x &lt; (j+1) / 5\)</span>.</p>
<p>Because <span class="math display">\[c_j :=
\int^{\frac{j+1}{5}}_{\frac{j}{5}} \frac{e ^ {-x}}{1 - e ^ {-1}} dx =
\frac{e^{-\frac{j}{5}} (1 - e^{-\frac{1}{5}})}{1 - e^{-1}},
\]</span></p>
<p>we can gain the pdf subinterval variables generated from <span class="math display">\[ X_j \sim f_j (x) := \frac{f(x)}{c_j} =
\frac{e^{-x}}{e^{-\frac{j}{5}} (1 - e^{-\frac{1}{5}})} , \frac{j}{5}
&lt; x &lt; \frac{j+1}{5},\]</span></p>
<p>Therefore <span class="math display">\[ F_j (x) =
\frac{e^{-\frac{j}{5}} - e^{-x}}{e^{-\frac{j}{5}} (1 -
e^{-\frac{1}{5}})}, \frac{j}{5} &lt; x &lt; \frac{j+1}{5}, \]</span></p>
<p>and <span class="math display">\[ F^{-1}_j (u) =
-log(e^{-\frac{j}{5}} - ue^{-\frac{j}{5}} (1 - e^{-\frac{1}{5}})), 0
&lt; u &lt; 1 \]</span></p>
<p>Now we use the stratified importance sampling method with a division
mentioned above to estimate <span class="math display">\[ \theta =
\int^1_0  e ^ {-x} / (1 + x^2) dx.\]</span></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>F_inverse15 <span class="ot">=</span> <span class="cf">function</span>(u, j)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>j <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">-</span> u <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>j <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> <span class="dv">5</span>))))</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>g15 <span class="ot">=</span> <span class="cf">function</span>(x)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>f15 <span class="ot">=</span> <span class="cf">function</span>(x, j)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> <span class="fu">exp</span>(<span class="sc">-</span>j <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> <span class="dv">5</span>)))</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>est15 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">50</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  U15 <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  sample15_1 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">2000</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">F_inverse15</span>(U15[j], <span class="dv">0</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    sample15_1[j] <span class="ot">=</span> <span class="fu">g15</span>(X) <span class="sc">/</span> <span class="fu">f15</span>(X, <span class="dv">0</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  sample15_2 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">2000</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>)</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">F_inverse15</span>(U15[j <span class="sc">+</span> <span class="dv">2000</span>], <span class="dv">1</span>)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>    sample15_2[j] <span class="ot">=</span> <span class="fu">g15</span>(X) <span class="sc">/</span> <span class="fu">f15</span>(X, <span class="dv">1</span>)</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  sample15_3 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">2000</span>)</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">F_inverse15</span>(U15[j <span class="sc">+</span> <span class="dv">4000</span>], <span class="dv">2</span>)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    sample15_3[j] <span class="ot">=</span> <span class="fu">g15</span>(X) <span class="sc">/</span> <span class="fu">f15</span>(X, <span class="dv">2</span>)</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  sample15_4 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">2000</span>)</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>)</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">F_inverse15</span>(U15[j <span class="sc">+</span> <span class="dv">6000</span>], <span class="dv">3</span>)</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>    sample15_4[j] <span class="ot">=</span> <span class="fu">g15</span>(X) <span class="sc">/</span> <span class="fu">f15</span>(X, <span class="dv">3</span>)</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>  sample15_5 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">2000</span>)</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>)</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">F_inverse15</span>(U15[j <span class="sc">+</span> <span class="dv">8000</span>], <span class="dv">4</span>)</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>    sample15_5[j] <span class="ot">=</span> <span class="fu">g15</span>(X) <span class="sc">/</span> <span class="fu">f15</span>(X, <span class="dv">4</span>)</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>  est15[i] <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">c</span>(<span class="fu">mean</span>(sample15_1), <span class="fu">mean</span>(sample15_2), <span class="fu">mean</span>(sample15_3), <span class="fu">mean</span>(sample15_4), <span class="fu">mean</span>(sample15_5)))</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(est15)</span></code></pre></div>
<pre><code>[1] 0.5247569</code></pre>
<p>This is the value of <span class="math inline">\(\hat\theta^{SI}\)</span>, and <span class="math inline">\(\hat\theta^I\)</span> use the importance sampling
method in Exercise 5.13 is <span class="math inline">\(0.5257801\)</span>.</p>
<p>Finally we compare the variance between <span class="math inline">\(\hat\theta^{SI}\)</span> and <span class="math inline">\(\hat\theta^I\)</span>, which are successively
given below:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(est15)</span></code></pre></div>
<pre><code>[1] 3.259202e-08</code></pre>
<p>and</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0970314</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co"># This data comes from Exercise 5.13.</span></span></code></pre></div>
<pre><code>[1] 0.009415093</code></pre>
<p>It is obiously that <span class="math inline">\(Var(\hat\theta^{SI})
&lt; Var(\hat\theta^I)\)</span>.</p>
</div>
</div>
<div id="hw4-2022-10-09" class="section level1">
<h1>HW4-2022-10-09</h1>
<div id="question-10" class="section level2">
<h2>Question</h2>
<p>(Exercise 6.4, Statistical Computating with R)</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p>I will answer this and following questions in form of that required
by the pdf as possible. Some illustration may turn to be in form of
annotation in the R code chunks.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>sample4 <span class="ot">=</span> <span class="cf">function</span>(n, meanlog, sdlog) <span class="co"># data generation</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rlnorm</span>(n, meanlog, sdlog))</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#test sample4()</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">sample4</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">breaks =</span> <span class="dv">25</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.01</span>), <span class="at">y =</span> <span class="fu">dlnorm</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">0.01</span>), <span class="at">sdlog =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAvVBMVEUAAAAAACsAAFUAKysAK1UAK4AAVYAAVaorAAArACsrAFUrKwArKysrK1UrK4ArVYArVaorgKorgNRVAABVACtVKwBVKytVgIBVgKpVgNRVqqpVqtRVqv+AKwCAVQCAVSuAgFWAgKqAqoCAqtSAqv+A1NSA1P+qVQCqVSuqVYCqgFWq1ICq1Kqq1NSq1P+q/9Sq///T09PUgCvUgFXUqlXUqoDU1KrU1NTU////qlX/1ID/1Kr//6r//9T///8q59afAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMTklEQVR4nO2dDXfbthWG4dSe1XldM7nu1sVptnYzs496NdN0oizx//+s4puQSOAlSFACqfueE4cCyQvgIQAC4CXIalJQ7NwJyF0ECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQJSgPbv2c1G/X9rfzTa/+vnxNHuP64Yezv05FYCa510rt391ZMMKPRB+4+MXf0lsOmmqh3YB9Drw5vUgCrGtR54ciegkilApc4Jz6vJktCtd/PAbjuwA1BLBUsOqGT6Og9RF6DtyuZccP/8wDQgHtOP9SfGHn2bB4lqB/pL0Kc7Xt6+fhZ8uASiz98y9kVTQq+fJDlu9ocH9uZZJeqrJ1HK2e3nO3b1rv604kc1kVkD0qRBZCOqQyZ4XP/lp18/29TKCvF2YzKgAFXSLC9OVyt1kLzkJl8dmwfcOwK9gEpZ3AQBA0iH6GhFDu+a4JtNpXbz9PHcKd0ZtOYKGQMuoCaiOmSiYHanSqA+5PpnZeT6QWaslAfznz+pLPGj1rVqkLo3GxbdgRaQkQYkLuGm/kU2FKqKbVea21rm5HazLwy3m+f6//ys323EQWuZ9LU4l73Tx5taYA00VcyJKGhCRPYsQswVLMRvebAsN/90r/+ntxt9zfUBIgvdmwe1tCPQB4gfff2TPqjQl1CeWKhCJbZ5LhQgU2l//fedMMDD1RW+2ZhYGzO1qZdPNlk2opCJQkUjzjZXcG1KDN9+VGgEblthJgWkQlSLI08xtVBkzWwf5HX/wRhQqVR/G0CuAQeQG1HIhE63jV60yqbOFbZZaUWXDtBxG/T6oKL/hz7FXBteux7NtgtIZPT677/eewG5Bty7WBNR0IROtzhbJrBiFlClL+BpAfGU/+3ONKk9SpAyv/MD8pQgJ6KgiY4SZGq2ab95W9WKLl0j3dlR3H/ftDj+NkjmVRYM28J2APK0QU5EQRMdbdCtNewHpP5z8nW86aShM9AHiCf2T7KeyRuPyI3/LmZK0M3m9b2/DfLcxZyIgiY67mK8l/R6by6mp5EWMb1reoftTac4dAZ6S9BH2wTK7kmoH2TboGAj7faD3BLURBQ0YYqJre26H+Q09gfdPCdLyqRn060vXYH+KvaLaBi+Eh1c2W1+1h3h79QJPOiPz6272PWP4rbrA+QYcKuYE1HABI/rf3z3101P+vXDSv12AJmhmJNHMS62I9T2pjtu6QocNd1x2J5Nq54Dwip+kFd0DD+bwGGACjlXwS9tl+1p1BMQv/aP+ChX21XHCU3gMECmEzJiSB6rvlMKZeRF23/4Lhg4sIq9fruyQ/DTqC+g3X3auRmacgUiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIEdCJAbLYX4jQJt3668+MUl+KCsVvpCxrn5sa5sBf2wrVwQKV0T5bup1FvC/JIOCC2eED798KHXPolljHurSIOTmf5gHb3vGZV6p2S/o6AuvF5kUVo2YCGlSDV+uh/ywbUtEESVd8YGkBs6YAG3cWYun2pP0sHNCgGAgRiaAC9LL6jaFXG3MUuEdCxlcBQQqO5bEAhcy4gaoMuHZB5adLbAl04oNK8Xln5lrZpm2OHgGZHKHqooeQbalw2IDlYVfINVi8bUJISNLd5xcg2SBeh4W3Q7GaF4tJq1j3yTnZcOqB4c+zoNj+7WSECBESAgAgQ0OkBzWzazKbVWbAohbkmYCmA1PI+Q1cP7TBnfi8HUJ2AUR9A8xpvHKe1DE1mxJtbGKCKqQW8hi+btGRAYhihyEQ8V/abs7+XAsguVJ3GXPO7DWiejfTuG8VnRPGpLwJQxBMvx4rvsY8H0IxmhXQqm8UsT3Cbf2Ez8jZrlaBE5uQP4xm0CEATmGscXwhQpzk/oBnNK6pU7u7XdhX5dHexBQGaxhwBAuYCgOYzbeYONdbyCwejlq9dMqBCrHh927027gBz9dIAiefKFR/LJxxqhADNZtrsAFAh1s9OCIi9LAgQr1u7e7GWfsIqtixAvCMkvsjQg0/nEtXH5urFAcKyfUl/d7I/oLlMm0WlUjt1JClB8wME/Q9rUYbU52BSAJpdFSt63b6Kq6cLBdT3JcJSfB/mMgH1fINnu/oiEaBZELKJ7HWD10f634Y66kkvCZAcZyQ0V/cANAdCrndHxISZb0ASBWgWyz6kSWP3Yx8CBMxBQHMg5CRRfpOyGOchtGRA1dVTKUbzIUJxb/ssC5B4z0C8YBCaD4p82wffxWbwAPqgoygABWYUI9/VYAjQyxwmPVolqPDP2ke+7dMHUP69xeM2qAx0FycoQXMCpLqKQS+quLd9egGaTxXrpai3fS4RUJS5noAyJ3Q0Fhv7WdDlAipU81KO9LUfUsXyJqRTV5nGOTBbGGFObS8IkDNbluzZPIM96RkBckZgyR499waUNyEDCPaRY8zpzd6AciaUA6Csi1AWgHImdH5Amc96GEDQLSHGnN7sB0hjGpeN6TTdUCMKUL5DMgIENN1jn0hAuRKarAQxPCd9CChTQtkAyrW7OAkgU9/iSlCeN/tpAKmMRwHKtZrlBCjLlpoAAWUFKEdCUwFiQQ7eHfkNW3MDlN3dPjtAuRHKDFB+vaHMABlMaVM1RnFJ6elAZT7kMxRQTtUsKiV9HahGA6rzKUQx6ejt/jIWUE5NUUwqejtQjQVkMY3KWhplWYKcinZ2RpFtUD8Hqo6JjmElKIOqNokDVRpAekd9XkgTTZilBKQsngvTZKP5ZICaycmzVLmBsYXf9kkKqP3Xq6EQQkr92GcGOgegBYsAASUerC5PiQery1PqoUbWmhrQoG/7RO2fdPew9naSwerg6GYOaNC3faL2zx3QkG/7RO2fPaDR5gjQuP0EiACN20+ALh7Q8kSAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBAKQFVYAGrut7+3v/EUT6UDDxuK6H1wPJrerJ4wLokCQGJFWSqYB5296El9vippT8Lwp8kbL0KrX60/XLg59PSAVIPhUKLx1ShZ9ZqXR7v0ipy+ZXgks5yIVF/3EOflqcDBHIonxXBZIbLSBBQefN9AFA5dNWfhIBkIQ4jgIDCC+uXAXw8+lAbVPwh3MJ5lQ6QuvigmQCAgk4RVSiHooIH18gU+4as5JsVoArcZgIfWQaLiPaKvlM5VTHsVOPFLyOHgIYs0HbCRroGgHqswOfNYakdXMIAhtzrT3mbDwMKrSJr0IRLYKAE9Tm9WyftKIZSuF2Fy4/IveN/4zvEu09cuPM20n0GAwFAupL4DRSwBgXbIHx6t2iwCkSAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQ0HkBOculKKnH6/v3Mlg7DVvv4vaGUTDAeADvvhni6JoXIO3JqzwutdOwdRppb9jTggHWK6ga8pHUrABpT14Vqp2GrdtRe8MIBFiXEl0w4zQVoO1Ku5tot5Pt6q+8pK9F8CO/pj+spEemRFFa/1PtyStzZJyGreNae6OJKxjQeAD7FvUJaSJAMokVZyEuo/De3a6kIz1Ps8wi3yP2yo/cy72CkPHkPbj01vWxvWEjCwc0HsDAvatTEwEyiZMNo6AlEeg/j4oHv54ckPqCqTjeePLab5qqkmScZ9sbNrJggOMBfF4nzgO5b2VUslatHmv7R3sMXj1xQCobIsR48tqGKQ0gx5bzOdnemqoNku/uqAbmzX9Wx4C+1BkQgIx/qvXktdc5URVTQcJoToCEiqsny8UPyFxn68l7WILGN9IqSESZGyCRfXVDalUxeRvWbZDbLrTboNG3eccDOKM2yHToRJJ472Z9DEh05Jy7mChs8rz2XWx8R7HxAM7oLiZaZtnZl67Bbl1TgP4s+0NNP8jUhsL2g2r7v/UuPt5o3o4KB1gP4Iz6QWGBot4aoXntvEUBw+y6yhFQ77ffquM2txVwuHc2YzEEqO+g6eNxk9IKcDXH0fwMRICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEC/AfjLFlDtj9CvAAAAAElFTkSuQmCC" /><!-- --></p>
<p>Because <span class="math inline">\(X \sim logN(\mu,
\sigma^2)\)</span> equals <span class="math inline">\(log X \sim N(\mu,
\sigma^2)\)</span>, we can simply transfer this question into the
circunstance of normal distribution by taking logarithm of the
samples.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>CI4 <span class="ot">=</span> <span class="cf">function</span>(<span class="at">m =</span> <span class="dv">1000</span>, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="co"># data analysis</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  mu_hat <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  sd_hat <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  UCL <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  DCL <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">=</span> <span class="fu">sample4</span>(n, meanlog, sdlog)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    mu_hat[i] <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">log</span>(data))</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    sd_hat[i] <span class="ot">=</span> <span class="fu">sd</span>(<span class="fu">log</span>(data)) <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    UCL[i] <span class="ot">=</span> mu_hat[i] <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>, n <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> sd_hat[i]</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    DCL[i] <span class="ot">=</span> mu_hat[i] <span class="sc">+</span> <span class="fu">qt</span>(alpha <span class="sc">/</span> <span class="dv">2</span>, n <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> sd_hat[i]</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    y[i] <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> (meanlog <span class="sc">&lt;</span> DCL[i]) <span class="sc">-</span> (meanlog <span class="sc">&gt;</span> UCL[i])</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mu =</span> mu_hat, <span class="at">sd =</span> sd_hat, <span class="at">UCL =</span> UCL, <span class="at">DCL =</span> DCL, <span class="at">CP =</span> <span class="fu">mean</span>(y)))</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#test CI4, we show a single estimate confidence interval. Following data is the estimate mean, standard deviation, DCL, UCL of the parameter.</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">=</span> <span class="fu">CI4</span>(<span class="at">m =</span> <span class="dv">1</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(temp<span class="sc">$</span>mu, temp<span class="sc">$</span>sd, temp<span class="sc">$</span>DCL, temp<span class="sc">$</span>UCL)</span></code></pre></div>
<pre><code>[1]  0.09331661  0.20901999 -0.34581809  0.53245132</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(temp)</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>resulting4 <span class="ot">=</span> <span class="cf">function</span>(<span class="at">m =</span> <span class="dv">1000</span>, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="co"># result reporting (these parameters seem a bit confusing)</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">=</span> <span class="fu">CI4</span>(m, n, meanlog, sdlog, alpha)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot, where we show some simulative CIs as examples.</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">=</span> <span class="fu">min</span>(m, <span class="dv">20</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>m1, <span class="at">y =</span> temp<span class="sc">$</span>UCL[<span class="dv">1</span><span class="sc">:</span>m1], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(temp<span class="sc">$</span>DCL[<span class="dv">1</span><span class="sc">:</span>m1]), <span class="fu">max</span>(temp<span class="sc">$</span>UCL[<span class="dv">1</span><span class="sc">:</span>m1])),</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">paste</span>(<span class="st">&quot;μ = &quot;</span>, meanlog, <span class="st">&quot;, σ = &quot;</span>, sdlog), <span class="at">ylab =</span> <span class="st">&quot;CI of μ&quot;</span>,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;Some Simulative Confidence Intervals of a Lognormal Distribution&quot;</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x =</span><span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">y =</span> temp<span class="sc">$</span>DCL[<span class="dv">1</span><span class="sc">:</span>m1])</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> meanlog, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#estimate CP</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(temp<span class="sc">$</span>CP)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>An example where <span class="math inline">\(m = 10000, n = 20, \mu =
0, \sigma = 1, \alpha = 0.05\)</span>:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The estimated CP is&quot;</span>, <span class="fu">resulting4</span>(<span class="at">m =</span> <span class="dv">10000</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>[1] &quot;The estimated CP is 0.9535&quot;</code></pre>
<p>Another example where <span class="math inline">\(m = 1000, n = 50,
\mu = 2, \sigma = 10, \alpha = 0.01\)</span>:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The estimated CP is&quot;</span>, <span class="fu">resulting4</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">meanlog =</span> <span class="dv">2</span>, <span class="at">sdlog =</span> <span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.01</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAwFBMVEUAAAAAACsAAFUAKysAK1UAK4AAVVUAVYAAVaorAAArACsrAFUrKwArKysrK1UrK4ArVYArVaorgKorgNRVAABVACtVKwBVKytVVVVVgKpVgNRVqtRVqv+AKwCAKyuAVQCAVSuAgCuAgFWAgKqAqoCAqtSAqv+A1NSA1P+qVQCqVSuqVYCqgCuqgFWq1NSq1P+q//++vr7UgCvUgFXUqlXUqoDU1KrU1NTU1P/U////qlX/1ID/1Kr//6r//9T/////mMJzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMIElEQVR4nO2da2PcqBWGGcdpx226jXfcbLvrtNtLup60XbvT7LaW7dH//1cVICHE7QVJSMz4vF8yluBweAQHpCDEalJQbG0HShcBAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIDcgI5f3jHGvroP5Tx+vmLs/Uf29rE7smcXD+keHHUT7aF/JNhx5DdTcE+vnacObHMXNu8E9PKBSe0COSue4OscgJ4/pNjBgCp/VcYBaorsdOvPadueC1CaHQwoQCECEGdw/MzY5lqVcmDs8lNzIRtOouifvmHszR8epb0fmrSXd7wWjTY/SO94I778JCvWG9NSN+K99s13okqD4mQFTcuNpYGhv31gFx8kuEr4/BNv5V/dKUD/acxv3mtBQXktPW05qGwuQH1FReGXd02NuPGXG9FaLh+Ux/IKHv94/T/Ji4t70f7kVnVAqsk1+TRjWurWTdHS7eIEoKHliwfL0NsvskXvefpKJR/k75te77UOqM/mAKRVVNZo864BtBNN+r5+uuq6aePZVmtjzQnpwE62rXv1W3nXFLt95Mwb/zRjeuomydePzzdGigEglVa2xKGht/f1f5uUW+Hejmf65aM8K/Jznx/rL32oGXrdUdCy2YD0LLJGDdoLdidL5Glb/Fr+ulYRQfxzENewSbAdAJJJXm7kdVfG9NQyyeH9j1ZxCtAwrW1I/dHW6ed/Nb1qK/M3GS9/rL1e6/2ozWYD0rP0NWIC6KDhDQF1MVCYkvZkE+sBySsrTevGtNRaJDWLUzFIWRbe2YZE1tvW0vF7eXarXGAqfri9lsdVNguQnqX7zWOQ6pfK42EX6/4SodENqEvCK6YbGwLqbJrFeQDZhkTSrbx8HMjlX3/u2T/Lmcnm716vWwNdNguQnkWrEZPXRW+dWpBuRoW4FtTxftCNeVuQWZynBRmGxI+LP4vfEtPA9PNf3rUR1t+CtGwJLcgIyuYwb/dmE5ARg7b1oHSt0nX11SerOA8g21Dddk/uetWFrJ3O/vgnNYy5Y5CWzQLki0Hi0Oa7uhlhVDmDiaI9HliA+pj/oBvTUzdJrkWkuDWLswHJ35YhWQkZr4VT/Aq2LUgMkryfae3UMYpp2VRbYN38wzOK1Wpi0rNUtxrXmhE5D3IC6iY52jyIp9NTd0m2VnE2oIpp86DeUNsExGVW17DrYp+NCY7tdT3MZgPyzIN4sufv+X2nNgttb1bbgVNMML81O40O6PjPq2aWLNtlb2wASM6kv7WLswGJWey9ZaiutXDAh6PLT3zcb12wbq9Nr41sDkBaFuHDb+/3LSCSR82knQA5tRfhhc9bCZBT3Sxsc0eA3Hr+5ko+HSBAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIKA3QnrGtWDoTWIF/ZkoCdBDL7cQaKM9bHOxklAPQ8SNfnCYWIx08r0ecTI/NAujlpulZlXxfYvi6SfqFWVvUgoCyAOpjkEA12VyMchHPAwiPYnPXJ1ufzQRoaXONvUyEzgQQy9bHCBC2PHPCNcyxCJPRUYoF/orONlmLA2JyEhZrzPNXdLbJmtUcgyYVGczICPdnBChgc1hl1NTODhAz/oWFhRAxI/0rAOTC4Ud0hoCY4xcuyYPICmfrAprFaBhQZGAaHiwG0BxWw/0hOLR5D60HyHoeZLT0EaUEAcG5kecI6LZxxibJ6UFgkhJ3wkgVMefx/F0SoHrQmHzFeNkFWiB22QvIhSrR1kQNOoZ2pxDA4ERkthn/KeiGO/SUAEjMXsNRu6UHY0xydPU1ucIARc9lYEz3BP8oR5ywCgEETgwCueunkTLlAazn2pwsIOC6N1gFXHH37tSZ2lKAAtM39SfzpJMn0z11GjxhQKJG3vnAOHccBoPD6lwFjzAXd7swszv+EbI8QKn3C5mVFdDTlXf1SwKgVfnkAdTu6CPk2SvzdQOqK7m1FbUgr15u+KoOG1DU8hc0W15U6YBU/wlvNLvf3I1sQacOqFWFlh8e2G4OQCvzmdDFfEujlJ6u3owDlPzQIqfGA6rCXawWu7K9ZkCwBY0vN/mpTkaNBhSIL9PLBY+HltSEUQwOZOPLTX+el00F3ov1Z0tYLVwmoJrFLubJrlIBFQGHq1BA5YgAASUCerm5ffkd+ALHvOWurWRAOwIUTHiYYxKUUu7aGjFRnNKCFN1/n4ySAc2jM25B7ScHNtMi0TkDqtpPxWS8WS1I6YC6d+QyPu4oSWPu5mXTwQ/MZil3bVELAqIYBESjGBDdrAIRICACBESAgDIB6j4/5Z0rLQ9oZIl5AB26L7tVvo8cLw5o7FPuLIC0HTuK2dxk7NYMyU8UYx6YdXcjdTnb47Cx1+S1tCA2tsxcMahtQqXEIGaXGelBMqDjR/7twKer0Bfm+67ovaFdFhCzy2SRYTsVkFx82P87VmsAstYdxSBKBbTvuHj3t0syN9odK2MoJzP+7X9iRImAIsJvijnr6MiRhoUHKcdqmv6QlW9UqNL+Z7U7kOOJ4hhADLys6MYS8GQioL4FzQ9oxGSFhapqHXYBMrNN3Nxkrz48vZ+/i6UDMq62z6r5O4RgIiC1NDHDGsURkzkzuSO7q7oBBKYTyfOgdup38M0AE82Zh9IA2anREVchFq5JgNonGdtQ2mhzjiuZRAg1GLvXRQEKxvAEX6bInoegschvxDjI3L/7LKFxy7pKKwOyJ3GTAfVYfFs1YECumcFIZ8ZK82B40UCl41wSE0fPVCsYpmwvFgbkfB40aPa+ajnWBYdcCuwjE0Id+IGUrQXV9fCl7NBchkXMC5NKNo45vCgCEIyKztMzeuTo38kxMS+g8BnnvG5Wh+wh9HQBjZkPRLrjuhCnAMg8Etyqaoo7pwHI5uFMksEfZ1w8TUDzv+xywoC8E6N55WuUWQHNsvPC7Ch8pU68Eil+Ttu7wz2q59aigKbt3TE4txQf/03gxPwe+fbuiDL3GgDNtXfHcnx8yhek59i7Y30+OUcx194dcctf0m+l8ynnMD95744C+GQG5P+fDwJUTwdUAp+SARXBp0xA8iwBChdWBp8S7+brHM97RosAAZUJiHZ/IUATzRXDp1RA5YgAAREgIAIEtBqgk9FKgGYvdf6KJNaYAM2bfCYRoNlKJUBzpSRAiycclXwmEaDZSiVAc6U8L0AnJAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQJaHpB84yNii4enX4v3QSq4RbFMiOyKrSV2cRY1LQ/o6Vdxzr3ciBdmqqYuVbA+bUJg9/ixMXLgALFFXcsDitzBqZJvFMn1fvtAg2sTIrvy9YDDxQO2ONDygA5RrlVsJ2qs6oUSxtltWg60ONTygPa/6WIBkAQkOk64dcizUXb3Fw8xFjUtDki+UbWPICTqIINFOGSIhFF2+QtvMRY1rTTMx1zANEAxdqsuRpcPKGYnsMQuhu3KFyZL72JSMWN9XJCuh4ACdg/6C6XlBmnpX3QXixmUNZIBu91OvcUP88K16CAdM61rR7Gw3X4f39InivW+GY5j9iJsW8MB3hi0CcN222/wcVPYoia6WQUiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECKg4QP1q3SRFrxlOVWmA+tW6SYpeM5ys0gAlLm9qFb1mOF1rrLS/hV9MtlpBJReveKoevWZ4hFYG9HSlVu3o2ht1rNht/51uZ57oBY2pKrIFmZ+zl10nGFyil8SmqkRAldmVZNcJr2B9RYDM9tOh0b7Y7ch0pl3MEU8cHwsetqBADDqTIL3T15yaOjgWYrYxKFTx6DXDqVoDUFOXvW+y7CYnR7FgXD+fieLLze8Z+4WvttpqXd4iusZQofuP6DXDqVopBkXq6TqjI3EqG1A17ePuc6hsQJ/n7S5jVNrNanEiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgoP8DXbmOWEVlPtoAAAAASUVORK5CYII=" /><!-- --></p>
<pre><code>[1] &quot;The estimated CP is 0.989&quot;</code></pre>
<p>Both estimated CP are close to <span class="math inline">\(1 -
\alpha\)</span>.</p>
</div>
<div id="question-11" class="section level2">
<h2>Question</h2>
<p>(Exercise 6.8, Statistical Computating with R)</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<p>The following function is based on the code of the example of Count
Five tset on the book.</p>
<p>And because the samples just come from normal distribution, there is
no need to write another data generater function. Thus we straightly
start from the data analysis function,</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>count5test8 <span class="ot">=</span> <span class="cf">function</span>(x, y) <span class="co"># data analysis</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">=</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">=</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">=</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X)) <span class="co"># return 1 (reject H0) or 0 (do not reject H0)</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  reject <span class="ot">=</span> <span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(reject)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>Ftest8 <span class="ot">=</span> <span class="cf">function</span>(x, y, <span class="at">alpha =</span> <span class="fl">0.95</span>)</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  reject <span class="ot">=</span> <span class="fu">as.integer</span>(<span class="fu">var.test</span>(x, y, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">conf.level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha)[[<span class="dv">3</span>]] <span class="sc">&lt;</span> alpha)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(reject)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#test functions above, through a single hypothesis test.</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rlnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rlnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="fl">1.2</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">count5test8</span>(x, y), <span class="fu">Ftest8</span>(x, y))</span></code></pre></div>
<pre><code>[1] 1 1</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(y)</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>resulting8 <span class="ot">=</span> <span class="cf">function</span>(<span class="at">m =</span> <span class="dv">1000</span>, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">sigma1 =</span> sigma1, <span class="at">sigma2 =</span> sigma2, <span class="at">alpha =</span> <span class="fl">0.055</span>) <span class="co"># result reporting</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  power_c5 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  power_F <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n))</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    reject1 <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    reject2 <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">=</span> <span class="fu">rnorm</span>(n[j], <span class="dv">0</span>, sigma1)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">=</span> <span class="fu">rnorm</span>(n[j], <span class="dv">0</span>, sigma2)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>      reject1[i] <span class="ot">=</span> <span class="fu">count5test8</span>(x, y)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>      reject2[i] <span class="ot">=</span> <span class="fu">Ftest8</span>(x, y, alpha)</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    power_c5[j] <span class="ot">=</span> <span class="fu">mean</span>(reject1)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>    power_F[j] <span class="ot">=</span> <span class="fu">mean</span>(reject2)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(reject1)</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(reject2)</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cbind</span>(n, power_c5, power_F))</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We let <span class="math inline">\(n = 20, 100, 500, 2000\)</span>
(small, medium, medium, big) seperately.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">resulting8</span>(<span class="at">n =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">2000</span>), <span class="at">sigma1 =</span> <span class="dv">1</span>, <span class="at">sigma2 =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<pre><code>        n power_c5 power_F
[1,]   20    0.321   0.430
[2,]  100    0.852   0.982
[3,]  500    0.992   1.000
[4,] 2000    1.000   1.000</code></pre>
<p>We can see the <span class="math inline">\(F\)</span> test has MORE
power than the Count Five test. The reason is the sample comes from
normal distribution, which is an assumption of <span class="math inline">\(F\)</span> test.</p>
</div>
<div id="question-12" class="section level2">
<h2>Question</h2>
<p>Discussion:</p>
<p>If we obtain the powers for two methods under a particular simulation
setting with <span class="math inline">\(10,000\)</span> experiments:
say, <span class="math inline">\(0.651\)</span> for one method and <span class="math inline">\(0.676\)</span> for another method. Can we say the
powers are different at <span class="math inline">\(0.05\)</span>
level?</p>
<p>What is the corresponding hypothesis test problem?</p>
<p>Which test can we use? Z-test, two-sample t-test, paired-t test or
McNemar test? Why?</p>
<p>Please provide the least necessary information for hypothesis
testing.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<div id="i" class="section level4">
<h4>i)</h4>
<p>Corresponding hypothesis test is testing whether two researching
targets are the same by testing their parameters are the same or not,
with an assumption of a consistent form of both targets. (This is a
parameter method.)</p>
<p>In this question, the power is the probability to examine the type-II
error, so we can set a hyperthesis testing problem as following:</p>
<p><span class="math inline">\(n = 10000\)</span>, samples <span class="math inline">\(X_1, ... , X_n i.i.d. \sim b(p_1)\)</span> and
<span class="math inline">\(Y_1, ... , Y_n i.i.d. \sim b(p_2)\)</span>.
However, <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span> may be not independent, because they
come from testing the same sample. Given <span class="math inline">\(\hat p_1 = \sum ^n _{i=1} X_i / n = 0.651\)</span>
and <span class="math inline">\(\hat p_2 = \sum ^n _{i=1} Y_i / n =
0.676\)</span>, test <span class="math display">\[ H_0 : p_1 - p_2 = 0
\longleftrightarrow H_a : p_1 - p_2 \neq 0.\]</span></p>
</div>
<div id="ii" class="section level4">
<h4>ii)</h4>
<p>According to analysis above, the Z-test, two sample t-test and paired
t-test are not the best, especially when <span class="math inline">\(n\)</span> is not big enough, because samples are
not from normal distributions. Thus we consider to use the McNemar
test.</p>
</div>
<div id="iii" class="section level4">
<h4>iii)</h4>
<p>The McNemar test statistic is <span class="math display">\[ \chi ^2 =
\frac {(n_{10} - n_{01}) ^ 2} {n_{10} + n_{01}} \sim \chi ^2 _1,
\]</span></p>
<p>where <span class="math inline">\(n_{ab}\)</span> stands for the
situation <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> happen at the same time. (<span class="math inline">\(a=0\)</span> means the count the first test
correctly rejects <span class="math inline">\(H^\star_0\)</span> and
<span class="math inline">\(a=1\)</span> means the count the first test
wrongly accepts <span class="math inline">\(H^\star_0\)</span>, and
<span class="math inline">\(b\)</span> is similar).</p>
<p>However, we only know <span class="math inline">\(n \hat p_1 = 6510 =
n_{00} + n_{01}\)</span> and <span class="math inline">\(n \hat p_2 =
6760 = n_{00} + n_{10}\)</span>. We can not gain <span class="math inline">\(n_{10} + n_{01}\)</span> through these data (but
can gain this during calculating the powers). So without additional
information such as <span class="math inline">\(n_{00}\)</span> or <span class="math inline">\(\hat p_{00}\)</span>, we can not judge whether the
powers are different or not.</p>
</div>
</div>
</div>
<div id="hw5-2022-10-14" class="section level1">
<h1>HW5-2022-10-14</h1>
<div id="question-13" class="section level2">
<h2>Question</h2>
<p>(Exercise 7.4, Statistical Computating with R)</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<p>Assume <span class="math inline">\(X_1,X_2,...,X_n i.i.d. \sim
Exp(\lambda)\)</span>. A sample from an exponentional distribution has
the pdf <span class="math display">\[ f(x,\lambda) = \lambda e^{-
\lambda x} \]</span>.</p>
<p>The likelihood function is <span class="math display">\[
L(\lambda;x_1, ... ,x_n) = \lambda ^ n e ^ {-n \overline x \lambda}.
\]</span></p>
<p>Then <span class="math display">\[ \frac{\partial
ln(L)}{\partial{\lambda}} = \frac{n}{\lambda} - n \overline x.
\]</span></p>
<p>Let <span class="math display">\[ \frac{\partial
ln(L)}{\partial{\lambda}} = 0, \]</span></p>
<p>and we can get the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math display">\[
\hat\lambda = \frac{1}{\overline X}. \]</span></p>
<p>Next we use the bootstrap method to estimate <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>sample4 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>B4 <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>lambdastar4 <span class="ot">=</span> <span class="fu">numeric</span>(B4)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>lambda4 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(sample4)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B4)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  lambdastar4[i] <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(<span class="fu">sample</span>(sample4, <span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(lambdastar4, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> lambda4, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="at">lambda.bootest =</span> <span class="fu">mean</span>(lambdastar4), <span class="at">lambda.MLE =</span> lambda4,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">bias =</span> <span class="fu">mean</span>(lambdastar4) <span class="sc">-</span> lambda4,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">se.boot =</span> <span class="fu">sd</span>(lambdastar4)))</span></code></pre></div>
<pre><code>lambda.bootest     lambda.MLE           bias        se.boot 
   0.010496853    0.009252120    0.001244732    0.004220931 </code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(lambdastar4)</span></code></pre></div>
</div>
<div id="question-14" class="section level2">
<h2>Question</h2>
<p>(Exercise 7.5, Statistical Computating with R)</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">=</span> <span class="cf">function</span>(dat, index) {<span class="fu">return</span>(<span class="fu">mean</span>(dat[index]))}</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>sampleb5 <span class="ot">=</span> boot<span class="sc">::</span><span class="fu">boot</span>(<span class="at">data =</span> sample4, <span class="at">statistic =</span> boot.mean, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>ci5 <span class="ot">=</span> boot<span class="sc">::</span><span class="fu">boot.ci</span>(<span class="at">boot.out =</span> sampleb5, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>ci.norm5 <span class="ot">=</span> ci5<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>ci.basic5 <span class="ot">=</span> ci5<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>ci.perc5 <span class="ot">=</span> ci5<span class="sc">$</span>perc[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>ci.BCa5 <span class="ot">=</span> ci5<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>ans5 <span class="ot">=</span> <span class="fu">rbind</span>(ci.norm5, ci.basic5, ci.perc5, ci.BCa5)</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ans5) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;percentile&quot;</span>, <span class="st">&quot;BCa&quot;</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ans5) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;confidence.l&quot;</span>, <span class="st">&quot;confidence.h&quot;</span>)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ans5)</span></code></pre></div>
<pre><code>           confidence.l confidence.h
norm           35.10424     182.5578
basic          24.41667     168.2479
percentile     47.91877     191.7500
BCa            57.41999     222.9803</code></pre>
<p>Because samples does not come from a normal distribution, the
position of these confidence intervals on parameter space may be not the
same. Also, the pdf of <span class="math inline">\(\overline X\)</span>
is not symmetric, which may lead differcence among the position of the
confidence intervals, too. (For example, the confidence interval of
standard bootstrap is on the left of the confidence interval of
percentile bootstrap in this question.)</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ci5)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ci.norm5)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ci.basic5)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ci.perc5)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ci.BCa5)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ans5)</span></code></pre></div>
</div>
<div id="question-15" class="section level2">
<h2>Question</h2>
<p>(Project 7.A, Statistical Computating with R)</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">=</span> <span class="cf">function</span>(dat, index)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(dat[index]))</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We write a function with the help of the R package boot to gain the
empirical bootstrap confidence intervals of the parameters and calculate
the data we want.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>bootciA <span class="ot">=</span> <span class="cf">function</span>(mu, sigma, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">m =</span> <span class="dv">1000</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  ci.norm <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, m, <span class="dv">2</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  ci.basic <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, m, <span class="dv">2</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  ci.perc <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, m, <span class="dv">2</span>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  ci.norm.cover <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  ci.basic.cover <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  ci.perc.cover <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  ci.norm.ml <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  ci.basic.ml <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  ci.perc.ml <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  ci.norm.mr <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  ci.basic.mr <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  ci.perc.mr <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>    sam <span class="ot">=</span> <span class="fu">rnorm</span>(n, mu, sigma)</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>    samb <span class="ot">=</span> boot<span class="sc">::</span><span class="fu">boot</span>(<span class="at">data =</span> sam, <span class="at">statistic =</span> boot.mean, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>    ci <span class="ot">=</span> boot<span class="sc">::</span><span class="fu">boot.ci</span>(<span class="at">boot.out =</span> samb, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>    ci.norm[i, ] <span class="ot">=</span> ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>    ci.basic[i, ] <span class="ot">=</span> ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>    ci.perc[i, ] <span class="ot">=</span> ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>    mu.sam <span class="ot">=</span> <span class="fu">mean</span>(sam)</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>    ci.norm.ml[i] <span class="ot">=</span> ci.norm[i, <span class="dv">2</span>] <span class="sc">&lt;</span> mu.sam</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>    ci.norm.mr[i] <span class="ot">=</span> ci.norm[i, <span class="dv">1</span>] <span class="sc">&gt;</span> mu.sam</span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>    ci.norm.cover[i] <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> ci.norm.ml[i] <span class="sc">-</span> ci.norm.mr[i]</span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>    ci.basic.ml[i] <span class="ot">=</span> ci.basic[i, <span class="dv">2</span>] <span class="sc">&lt;</span> mu.sam</span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>    ci.basic.mr[i] <span class="ot">=</span> ci.basic[i, <span class="dv">1</span>] <span class="sc">&gt;</span> mu.sam</span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>    ci.basic.cover[i] <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> ci.basic.ml[i] <span class="sc">-</span> ci.basic.mr[i]</span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a>    ci.perc.ml[i] <span class="ot">=</span> ci.perc[i, <span class="dv">2</span>] <span class="sc">&lt;</span> mu.sam</span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a>    ci.perc.mr[i] <span class="ot">=</span> ci.perc[i, <span class="dv">1</span>] <span class="sc">&gt;</span> mu.sam</span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a>    ci.perc.cover[i] <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> ci.perc.ml[i] <span class="sc">-</span> ci.perc.mr[i]</span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="fu">mean</span>(ci.norm.cover), <span class="fu">mean</span>(ci.norm.ml), <span class="fu">mean</span>(ci.norm.mr)),</span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">mean</span>(ci.basic.cover), <span class="fu">mean</span>(ci.basic.ml), <span class="fu">mean</span>(ci.basic.mr)),</span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">mean</span>(ci.perc.cover), <span class="fu">mean</span>(ci.perc.ml), <span class="fu">mean</span>(ci.perc.mr))))</span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The answer is shown below.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>ansA <span class="ot">=</span> <span class="fu">bootciA</span>(<span class="at">mu =</span> <span class="dv">2</span>, <span class="at">sigma =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ansA) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;coveraged.p&quot;</span>, <span class="st">&quot;missed.l&quot;</span>, <span class="st">&quot;missed.r&quot;</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ansA) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>ansA</span></code></pre></div>
<pre><code>      coveraged.p missed.l missed.r
norm            1        0        0
basic           1        0        0
perc            1        0        0</code></pre>
<p>(This question seems confused, because it asks us to check the
empirical coverage rates for the SAMPLE mean, not <span class="math inline">\(\mu\)</span>, which means the bootstrap confidence
interval based on a sample must cover the mean of the sample. This leads
the coverage rate shold be <span class="math inline">\(1\)</span>, and
the missed porpotion should be <span class="math inline">\(0\)</span>.
This is meaningless. I have tried using the confidences interval to
contrast with the origin parameter <span class="math inline">\(mu\)</span> instead of sample mean and gained a
result which can explain the confidence coefficient.)</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ansA)</span></code></pre></div>
</div>
</div>
<div id="hw6-2022-10-21" class="section level1">
<h1>HW6-2022-10-21</h1>
<p>(Exercise 7.8, Statistical Computating with R)</p>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>principal.jack <span class="ot">=</span> <span class="cf">function</span>(dat8) <span class="co"># Calculate the estimate propotion of the first principal component of a matrix using jacknife</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  n8 <span class="ot">=</span> <span class="fu">dim</span>(dat8)[<span class="dv">1</span>]</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  p8 <span class="ot">=</span> <span class="fu">dim</span>(dat8)[<span class="dv">2</span>]</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  lambda8 <span class="ot">=</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(dat8))<span class="sc">$</span>values</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  theta8 <span class="ot">=</span> lambda8[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda8) <span class="co"># normal estimate value</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  lambda.jack8 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n8, <span class="at">ncol =</span> p8)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  theta.jack8 <span class="ot">=</span> <span class="fu">numeric</span>(n8)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n8)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>    lambda.jack8[i, ] <span class="ot">=</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(dat8[<span class="sc">-</span>i, ]))<span class="sc">$</span>values</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>    theta.jack8[i] <span class="ot">=</span> lambda.jack8[i, <span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda.jack8[i, ])</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="st">&quot;theta.hat&quot;</span> <span class="ot">=</span> theta8,</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;theta.jack.mean&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(theta.jack8),</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;bias.jack&quot;</span> <span class="ot">=</span> (n8 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta.jack8) <span class="sc">-</span> theta8),</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;sd.jack&quot;</span> <span class="ot">=</span> <span class="fu">sqrt</span>((n8 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n8 <span class="sc">*</span> <span class="fu">sum</span>((theta.jack8 <span class="sc">-</span> <span class="fu">mean</span>(theta.jack8)) <span class="sc">^</span> <span class="dv">2</span>))))</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>dat8 <span class="ot">=</span> bootstrap<span class="sc">::</span>scor</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">principal.jack</span>(dat8)</span></code></pre></div>
<pre><code>      theta.hat theta.jack.mean       bias.jack         sd.jack 
    0.619115038     0.619127327     0.001069139     0.049552307 </code></pre>
<p>The values above are <span class="math inline">\(\hat\theta,
\overline {\hat \theta}_{(\cdot)}, \widehat{E(\hat\theta) - \theta},
\hat{SE}(\hat\theta)\)</span> seperately.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dat8)</span></code></pre></div>
</div>
<div id="question-16" class="section level2">
<h2>Question</h2>
<p>(Exercise 7.11, Statistical Computating with R)</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>leaveto <span class="ot">=</span> <span class="cf">function</span>(dat11) <span class="co"># Using the leave-two-out CV to calculate the MSE of each model above.</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  n11 <span class="ot">=</span> <span class="fu">dim</span>(dat11)[<span class="dv">1</span>]</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  eps11_1 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n11 <span class="sc">*</span> (n11 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n11<span class="dv">-1</span>))</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n11)</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>      count <span class="ot">=</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>      fit <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> dat11<span class="sc">$</span>magnetic[<span class="sc">-</span><span class="fu">c</span>(i, j)],</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x =</span> dat11<span class="sc">$</span>chemical[<span class="sc">-</span><span class="fu">c</span>(i, j)]))</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>      eps11_1[count, ] <span class="ot">=</span> dat11<span class="sc">$</span>magnetic[<span class="fu">c</span>(i, j)] <span class="sc">-</span> <span class="fu">predict</span>(fit,</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>                                                           <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> dat11<span class="sc">$</span>chemical[<span class="fu">c</span>(i, j)]))</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>  sigma2.hat11_1 <span class="ot">=</span> <span class="fu">mean</span>(eps11_1<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>  eps11_2 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n11 <span class="sc">*</span> (n11 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n11<span class="dv">-1</span>))</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n11)</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>      count <span class="ot">=</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>      fit <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> x2,</span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> dat11<span class="sc">$</span>magnetic[<span class="sc">-</span><span class="fu">c</span>(i, j)],</span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> dat11<span class="sc">$</span>chemical[<span class="sc">-</span><span class="fu">c</span>(i, j)],</span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x2 =</span>  dat11<span class="sc">$</span>chemical[<span class="sc">-</span><span class="fu">c</span>(i, j)] <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a>      eps11_2[count, ] <span class="ot">=</span> dat11<span class="sc">$</span>magnetic[<span class="fu">c</span>(i, j)] <span class="sc">-</span> <span class="fu">predict</span>(fit,</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>                                                           <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> dat11<span class="sc">$</span>chemical[<span class="fu">c</span>(i, j)],</span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>                                                                                <span class="at">x2 =</span> dat11<span class="sc">$</span>chemical[<span class="fu">c</span>(i, j)] <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a>  sigma2.hat11_2 <span class="ot">=</span> <span class="fu">mean</span>(eps11_2<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a>  eps11_3 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n11 <span class="sc">*</span> (n11 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb88-39"><a href="#cb88-39" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb88-40"><a href="#cb88-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n11<span class="dv">-1</span>))</span>
<span id="cb88-41"><a href="#cb88-41" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb88-42"><a href="#cb88-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n11)</span>
<span id="cb88-43"><a href="#cb88-43" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb88-44"><a href="#cb88-44" aria-hidden="true" tabindex="-1"></a>      count <span class="ot">=</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb88-45"><a href="#cb88-45" aria-hidden="true" tabindex="-1"></a>      fit <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> <span class="fu">log</span>(dat11<span class="sc">$</span>magnetic[<span class="sc">-</span><span class="fu">c</span>(i, j)]),</span>
<span id="cb88-46"><a href="#cb88-46" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x =</span> dat11<span class="sc">$</span>chemical[<span class="sc">-</span><span class="fu">c</span>(i, j)]))</span>
<span id="cb88-47"><a href="#cb88-47" aria-hidden="true" tabindex="-1"></a>      eps11_3[count, ] <span class="ot">=</span> dat11<span class="sc">$</span>magnetic[<span class="fu">c</span>(i, j)] <span class="sc">-</span> <span class="fu">exp</span>(<span class="fu">predict</span>(fit,</span>
<span id="cb88-48"><a href="#cb88-48" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> dat11<span class="sc">$</span>chemical[<span class="fu">c</span>(i, j)])))</span>
<span id="cb88-49"><a href="#cb88-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb88-50"><a href="#cb88-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-51"><a href="#cb88-51" aria-hidden="true" tabindex="-1"></a>  sigma2.hat11_3 <span class="ot">=</span> <span class="fu">mean</span>(eps11_3<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-52"><a href="#cb88-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-53"><a href="#cb88-53" aria-hidden="true" tabindex="-1"></a>  eps11_4 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> n11 <span class="sc">*</span> (n11 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb88-54"><a href="#cb88-54" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb88-55"><a href="#cb88-55" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n11<span class="dv">-1</span>))</span>
<span id="cb88-56"><a href="#cb88-56" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb88-57"><a href="#cb88-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n11)</span>
<span id="cb88-58"><a href="#cb88-58" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb88-59"><a href="#cb88-59" aria-hidden="true" tabindex="-1"></a>      count <span class="ot">=</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb88-60"><a href="#cb88-60" aria-hidden="true" tabindex="-1"></a>      fit <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> <span class="fu">log</span>(dat11<span class="sc">$</span>magnetic[<span class="sc">-</span><span class="fu">c</span>(i, j)]),</span>
<span id="cb88-61"><a href="#cb88-61" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x =</span> <span class="fu">log</span>(dat11<span class="sc">$</span>chemical[<span class="sc">-</span><span class="fu">c</span>(i, j)])))</span>
<span id="cb88-62"><a href="#cb88-62" aria-hidden="true" tabindex="-1"></a>      eps11_4[count, ] <span class="ot">=</span> dat11<span class="sc">$</span>magnetic[<span class="fu">c</span>(i, j)] <span class="sc">-</span> <span class="fu">exp</span>(<span class="fu">predict</span>(fit,</span>
<span id="cb88-63"><a href="#cb88-63" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">log</span>(dat11<span class="sc">$</span>chemical[<span class="fu">c</span>(i, j)]))))</span>
<span id="cb88-64"><a href="#cb88-64" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb88-65"><a href="#cb88-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-66"><a href="#cb88-66" aria-hidden="true" tabindex="-1"></a>  sigma2.hat11_4 <span class="ot">=</span> <span class="fu">mean</span>(eps11_4<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-67"><a href="#cb88-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-68"><a href="#cb88-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(sigma2.hat11_1, sigma2.hat11_2, sigma2.hat11_3, sigma2.hat11_4), <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb88-69"><a href="#cb88-69" aria-hidden="true" tabindex="-1"></a>                <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;sigma2.hat&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;Model I&quot;</span>, <span class="st">&quot;Model II&quot;</span>, <span class="st">&quot;Model III&quot;</span>, <span class="st">&quot;Model IV&quot;</span>))))</span>
<span id="cb88-70"><a href="#cb88-70" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>dat11 <span class="ot">=</span> DAAG<span class="sc">::</span>ironslag</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leaveto</span>(dat11)</span></code></pre></div>
<pre><code>            Model I Model II Model III Model IV
sigma2.hat 19.57227 17.87018  18.45491 20.46718</code></pre>
<p>We can see the Model II has the smallest prediction error through the
leave-two-out CV, which is the best. The result is consistant with the
best model chosen in Example 7.18 where the leave-one-out CV is
used.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dat11)</span></code></pre></div>
</div>
<div id="question-17" class="section level2">
<h2>Question</h2>
<p>(Exercise 8.2, Statistical Computating with R)</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<p>In this question, <span class="math display">\[ H_0: \rho = 0
\longleftrightarrow H_1: \rho \neq 0.\]</span></p>
<p>If we consider accept <span class="math inline">\(H_0\)</span>, the
sample would be uncorrelated. Thus the permutation of the sample should
be uncorrelated, too.</p>
<p>The p-value of permutation test is <span class="math display">\[
P(\left| \rho^* \right| &gt; \left| \rho \right|),\]</span></p>
<p>where <span class="math inline">\(\rho\)</span> is the spearman
correlation coefficient of original sample and <span class="math inline">\(\rho^*\)</span> is the spearman correlation
coefficient of permutation sample.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>spearman.per <span class="ot">=</span> <span class="cf">function</span>(x, y, <span class="at">m =</span> <span class="dv">10000</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  rho <span class="ot">=</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">=</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">=</span> <span class="fu">length</span>(x)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">=</span> <span class="fu">length</span>(y)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">=</span> <span class="fu">c</span>(x, y)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  rho.per <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>    z.per <span class="ot">=</span> <span class="fu">sample</span>(z)</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>    rho.per[i] <span class="ot">=</span> <span class="fu">cor</span>(z.per[<span class="dv">1</span><span class="sc">:</span>n1], z.per[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n1<span class="sc">+</span>n2)], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>  p.value.per <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(rho) <span class="sc">&lt;</span> <span class="fu">abs</span>(rho.per)) <span class="sc">/</span> m</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">rho =</span> rho, <span class="at">p.value =</span> p.value, <span class="at">p.value.per =</span> p.value.per))</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We generate samples in following method:</p>
<p><span class="math display">\[X_i = i, i = 1, ... , 10\]</span></p>
<p>and</p>
<p><span class="math display">\[Y_i = X_i + \epsilon_i, \epsilon_i
i.i.d. \sim N(0, 9) \]</span></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(x, y)</span></code></pre></div>
<pre><code>      [,1]     [,2]     [,3]     [,4]     [,5]      [,6]     [,7]     [,8]
x 1.000000 2.000000 3.000000 4.000000 5.000000 6.0000000  7.00000 8.000000
y 0.830857 6.084798 1.063656 7.822281 6.588162 0.1473242 11.07976 4.421713
      [,9]    [,10]
x 9.000000 10.00000
y 8.027735 12.54012</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spearman.per</span>(x, y)</span></code></pre></div>
<pre><code>        rho     p.value p.value.per 
 0.60000000  0.07311988  0.06780000 </code></pre>
<p>We can see the p-values from the function cor.test and the
permutation test are similar and they both suggest rejecting <span class="math inline">\(H_0\)</span> when the confidence is <span class="math inline">\(0.10\)</span>.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(y)</span></code></pre></div>
</div>
</div>
<div id="hw7-2022-10-28" class="section level1">
<h1>HW7-2022-10-28</h1>
<p>(Exercise 9.4, Statistical Computating with R)</p>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<p>Target density is <span class="math display">\[ f(x) = \frac{1}{2} e
^ {-\left| x \right|}, x \in \mathbb{R} \]</span></p>
<p>The random walk Metropolis proposal distribution satisfies that <span class="math display">\[ g(r|s) = \frac{1}{\sqrt{2\pi \sigma^2}} e ^
{-\frac{(r - s) ^ 2}{2 \sigma^2}} = g(s|r)\]</span></p>
<p>Thus the acceptance probability is <span class="math display">\[
\alpha(s, r) = min\{ \frac{f(r)}{f(s)}, 1 \}  = min\{ e^{\left| s
\right| - \left| r \right|}, 1 \} \]</span></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>RWMetroplois <span class="ot">=</span> <span class="cf">function</span>(ini, sigma, <span class="at">m =</span> <span class="dv">10000</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">=</span> ini</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[t <span class="sc">-</span> <span class="dv">1</span>], sigma) <span class="co">#generate</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(u <span class="sc">&lt;=</span> <span class="fu">min</span>(<span class="fu">exp</span>(<span class="fu">abs</span>(x[t <span class="sc">-</span> <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">abs</span>(y)), <span class="dv">1</span>))</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>      x[t] <span class="ot">=</span> y</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>      x[t] <span class="ot">=</span> x[t <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>      count <span class="ot">=</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> x, <span class="at">rejectrate =</span> count <span class="sc">/</span> m))</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we generate 4 sample chains with initial value <span class="math inline">\(x_0 = 5\)</span> and <span class="math inline">\(\sigma = 0.05, 0.25, 1, 5\)</span> and <span class="math inline">\(m = 10000\)</span>.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>x41 <span class="ot">=</span> <span class="fu">RWMetroplois</span>(x0, <span class="fl">0.05</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>x42 <span class="ot">=</span> <span class="fu">RWMetroplois</span>(x0, <span class="fl">0.25</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>x43 <span class="ot">=</span> <span class="fu">RWMetroplois</span>(x0, <span class="dv">1</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>x44 <span class="ot">=</span> <span class="fu">RWMetroplois</span>(x0, <span class="dv">5</span>)</span></code></pre></div>
<p>The reject rates:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>rej4 <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="dv">1</span>, <span class="dv">5</span>), <span class="fu">c</span>(x41<span class="sc">$</span>rejectrate, x42<span class="sc">$</span>rejectrate, x43<span class="sc">$</span>rejectrate, x44<span class="sc">$</span>rejectrate))</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rej4) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;reject.rate&quot;</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>rej4</span></code></pre></div>
<pre><code>     sigma reject.rate
[1,]  0.05      0.0173
[2,]  0.25      0.0954
[3,]  1.00      0.3025
[4,]  5.00      0.7039</code></pre>
<p>The MC chains:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x41<span class="sc">$</span>x, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;sigma = 0.05&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Xt&quot;</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x42<span class="sc">$</span>x, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;sigma = 0.25&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Xt&quot;</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x43<span class="sc">$</span>x, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;sigma = 1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Xt&quot;</span>)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x44<span class="sc">$</span>x, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;sigma = 5&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Xt&quot;</span>)</span></code></pre></div>
<p>We can see the chain generated with <span class="math inline">\(\sigma = 0.05\)</span> does not converged in the
first <span class="math inline">\(10000\)</span> steps, but other three
chains converge in <span class="math inline">\(10000\)</span> steps.</p>
<p>In addition, we use the Gelman-Rubin method to monitor convergence of
the chains. We write a function to compute the Gelman-Rubin statistic
<span class="math inline">\(= \sqrt{\hat R}\)</span> of a group of
sample chains first.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>GelmanRubin <span class="ot">=</span> <span class="cf">function</span>(phi)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">=</span> <span class="fu">nrow</span>(phi)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  phi.chain.mean <span class="ot">=</span> <span class="fu">rowMeans</span>(phi)</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>  Bn <span class="ot">=</span> n <span class="sc">*</span> <span class="fu">var</span>(phi.chain.mean)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  phi.chain.variance <span class="ot">=</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>  Wn <span class="ot">=</span> <span class="fu">mean</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">*</span> phi.chain.variance)</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>  phi.variance.hat <span class="ot">=</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">*</span> Wn <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> n <span class="sc">*</span> Bn</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>  GR <span class="ot">=</span> <span class="fu">sqrt</span>(phi.variance.hat <span class="sc">/</span> Wn)</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(GR)</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we apply this function to this question to check the convergence
of chains generated with <span class="math inline">\(\sigma = 0.05,
0.25, 1, 5\)</span>. The initial value comes from <span class="math inline">\(N(0, 5)\)</span>. And noticed that the situation
where <span class="math inline">\(\sigma = 0.05\)</span> does not
converge in <span class="math inline">\(10000\)</span> steps, we will
straightly compute the Gelman-Rubin statistic to support the
conclusion.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>n.converge <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  ini <span class="ot">=</span> <span class="fu">rnorm</span>(k, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>    phi <span class="ot">=</span> <span class="fu">rbind</span>(phi, <span class="fu">RWMetroplois</span>(ini[j], sigma[i], m)<span class="sc">$</span>x)</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>    GR1 <span class="ot">=</span> <span class="fu">GelmanRubin</span>(<span class="fu">as.matrix</span>(phi))</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m)</span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>      GR <span class="ot">=</span> <span class="fu">GelmanRubin</span>(<span class="fu">as.matrix</span>(phi)[, <span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(GR <span class="sc">&lt;</span> <span class="fl">1.2</span>)</span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>        n.converge[i<span class="dv">-1</span>] <span class="ot">=</span> n</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The Gelman-Rubin statistic when <span class="math inline">\(\sigma =
0.05\)</span>:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>GR1</span></code></pre></div>
<pre><code>[1] 1.854713</code></pre>
<p>It is still far away from <span class="math inline">\(1.2\)</span>,
which can support our conclusion.</p>
<p>The estimate steps chains when <span class="math inline">\(\sigma =
0.25, 1, 5\)</span> needs to converge:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(<span class="fu">cbind</span>(<span class="at">sigma =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="dv">1</span>, <span class="dv">5</span>), <span class="at">step.converge =</span> n.converge))</span></code></pre></div>
<pre><code>     sigma step.converge
[1,]  0.25          1086
[2,]  1.00            53
[3,]  5.00            17</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(phi)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x41)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x42)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x43)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x44)</span></code></pre></div>
</div>
<div id="question-18" class="section level2">
<h2>Question</h2>
<p>(Exercise 9.7, Statistical Computating with R)</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<p>Target distribution is <span class="math display">\[ (X, Y) \sim N_2
(0, \Sigma), \Sigma = \left( \begin{array}{l} 1 &amp; 0.9 \\ 0.9 &amp; 1
\end{array} \right). \]</span></p>
<p>Thus <span class="math display">\[ X|Y \sim N(0.9Y, 0.19),
\]</span></p>
<p>and <span class="math display">\[ Y|X \sim N(0.9X, 0.19).
\]</span></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>Gibbs <span class="ot">=</span> <span class="cf">function</span>(ini, mu1, mu2, sigma1, sigma2, rho, <span class="at">n =</span> <span class="dv">10000</span>, <span class="at">burn =</span> <span class="dv">1000</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, <span class="dv">2</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">*</span> sigma1</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">*</span> sigma2</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>, ] <span class="ot">=</span> ini</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n)</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">=</span> x[i <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">=</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>    x[i, <span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">=</span> x[i, <span class="dv">1</span>]</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">=</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>    x[i, <span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n, ])</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we generate the bivaariate normal chain by a Gibbs sampler. The
plot is a burn-in sample where the first sample points are removed.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>x7 <span class="ot">=</span> <span class="fu">Gibbs</span>(<span class="at">ini =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>), <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.9</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x7, <span class="at">cex =</span> .<span class="dv">5</span>, <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>fit7 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> x7[, <span class="dv">2</span>], <span class="at">x =</span> x7[, <span class="dv">1</span>]))</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit7)</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x, data = data.frame(y = x7[, 2], x = x7[, 1]))

Residuals:
    Min      1Q  Median      3Q     Max 
-1.5555 -0.3051  0.0079  0.3007  1.9312 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.001215   0.004642  -0.262    0.794    
x            0.907305   0.004602 197.154   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4403 on 8998 degrees of freedom
Multiple R-squared:  0.812, Adjusted R-squared:  0.812 
F-statistic: 3.887e+04 on 1 and 8998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The F-test of the regression support the constant variance of the
model.</p>
<p>We graph a QQplot to check the normality of residuals:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>qqplot <span class="ot">=</span> <span class="cf">function</span>(fit)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  eps <span class="ot">=</span> fit<span class="sc">$</span>residuals</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">length</span>(eps)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">=</span> <span class="fu">qnorm</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span> <span class="sc">/</span> n)[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">/</span> n)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> q, <span class="at">y =</span> <span class="fu">sort</span>(eps), <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlab =</span> <span class="st">&quot;qnorm&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;residuals&quot;</span>)</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(fit7)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This QQplot suggest the normality of residuals.</p>
<p>Now we usethe Gelman-Rubin method to check the convergence of chains
and whether setting the burn-in <span class="math inline">\(=
1000\)</span> is suitable.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>ini <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(k, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(k, <span class="dv">5</span>, <span class="dv">5</span>)), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>phix <span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>phiy <span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">=</span> <span class="fu">Gibbs</span>(ini[j, ], <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.9</span>, <span class="at">burn =</span> <span class="dv">0</span>) <span class="co"># Do not remove.</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>  phix <span class="ot">=</span> <span class="fu">rbind</span>(phix, temp[, <span class="dv">1</span>])</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  phiy <span class="ot">=</span> <span class="fu">rbind</span>(phiy, temp[, <span class="dv">2</span>])</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m)</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>  GR1 <span class="ot">=</span> <span class="fu">GelmanRubin</span>(<span class="fu">as.matrix</span>(phix)[, <span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>  GR2 <span class="ot">=</span> <span class="fu">GelmanRubin</span>(<span class="fu">as.matrix</span>(phiy)[, <span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(GR1 <span class="sc">&lt;</span> <span class="fl">1.2</span> <span class="sc">&amp;</span> GR2 <span class="sc">&lt;</span> <span class="fl">1.2</span>)</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The converge step:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>n</span></code></pre></div>
<pre><code>[1] 24</code></pre>
<p>Which is far away from burn-in <span class="math inline">\(=
1000\)</span>.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x7)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(phix)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(phiy)</span></code></pre></div>
</div>
</div>
<div id="hw8-2022-11-05" class="section level1">
<h1>HW8-2022-11-05</h1>
<div id="question-19" class="section level2">
<h2>Question</h2>
<p>Classwork1.</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>Sample <span class="ot">=</span> <span class="cf">function</span>(<span class="at">N =</span> <span class="dv">20</span>, al, be, gam, <span class="at">intercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="co"># data generator</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  eps <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span>N, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">runif</span>(N)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">=</span> intercept[<span class="dv">1</span>] <span class="sc">+</span> al <span class="sc">*</span> X <span class="sc">+</span> eps[<span class="dv">1</span><span class="sc">:</span>N]</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">=</span> intercept[<span class="dv">2</span>] <span class="sc">+</span> be <span class="sc">*</span> M <span class="sc">+</span> gam <span class="sc">*</span> X <span class="sc">+</span> eps[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>N)]</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="fu">cbind</span>(X, M, Y)))</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>T.stat <span class="ot">=</span> <span class="cf">function</span>(dat)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(dat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">=</span> <span class="fu">lm</span>(M <span class="sc">~</span> X, <span class="at">data =</span> dat)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">=</span> <span class="fu">lm</span>(Y <span class="sc">~</span> M <span class="sc">+</span> X, <span class="at">data =</span> dat)</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  T <span class="ot">=</span> fit1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> fit2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">sqrt</span>(fit1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span>  (<span class="fu">summary</span>(fit1)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> fit2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="fu">summary</span>(fit2)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(T)</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>testalpha <span class="ot">=</span> <span class="cf">function</span>(dat, R, con)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="fu">nrow</span>(dat)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  T0 <span class="ot">=</span> <span class="fu">T.stat</span>(dat)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  Tper <span class="ot">=</span> <span class="fu">numeric</span>(R)</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R)</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>    ix <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>    Tper[i] <span class="ot">=</span> <span class="fu">T.stat</span>(<span class="fu">data.frame</span>(<span class="fu">cbind</span>(dat<span class="sc">$</span>X[ix], dat<span class="sc">$</span>M, dat<span class="sc">$</span>Y)))</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(Tper) <span class="sc">&gt;=</span> <span class="fu">abs</span>(T0))</span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p <span class="sc">&lt;</span> con)</span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>testbeta <span class="ot">=</span> <span class="cf">function</span>(dat, R, con)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="fu">nrow</span>(dat)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  T0 <span class="ot">=</span> <span class="fu">T.stat</span>(dat)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  Tper <span class="ot">=</span> <span class="fu">numeric</span>(R)</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R)</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    ix <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>    Tper[i] <span class="ot">=</span> <span class="fu">T.stat</span>(<span class="fu">data.frame</span>(<span class="fu">cbind</span>(dat<span class="sc">$</span>X, dat<span class="sc">$</span>M, dat<span class="sc">$</span>Y[ix])))</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(Tper) <span class="sc">&gt;=</span> <span class="fu">abs</span>(T0))</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p <span class="sc">&lt;</span> con)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>testalphabeta <span class="ot">=</span> <span class="cf">function</span>(dat, R, con)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="fu">nrow</span>(dat)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  T0 <span class="ot">=</span> <span class="fu">T.stat</span>(dat)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  Tper <span class="ot">=</span> <span class="fu">numeric</span>(R)</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R)</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>    ix <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>    Tper[i] <span class="ot">=</span> <span class="fu">T.stat</span>(<span class="fu">data.frame</span>(<span class="fu">cbind</span>(dat<span class="sc">$</span>X, dat<span class="sc">$</span>M[ix], dat<span class="sc">$</span>Y)))</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(Tper) <span class="sc">&gt;=</span> <span class="fu">abs</span>(T0))</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p <span class="sc">&lt;</span> con)</span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>TypeIError <span class="ot">=</span> <span class="cf">function</span>(al, be, gam, <span class="at">R =</span> <span class="dv">59</span>, <span class="at">N =</span> <span class="dv">100</span>, <span class="at">con =</span> <span class="fl">0.05</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  I.error1 <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  I.error2 <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  I.error3 <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">=</span> <span class="fu">Sample</span>(<span class="at">al =</span> al, <span class="at">be =</span> be, <span class="at">gam =</span> gam)</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>    I.error1[i] <span class="ot">=</span> <span class="fu">testalpha</span>(dat, <span class="at">R =</span> R, <span class="at">con =</span> con)</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>    I.error2[i] <span class="ot">=</span> <span class="fu">testbeta</span>(dat, <span class="at">R =</span> R, <span class="at">con =</span> con)</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>    I.error3[i] <span class="ot">=</span> <span class="fu">testalphabeta</span>(dat, <span class="at">R =</span> R, <span class="at">con =</span> con)</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">mean</span>(I.error1), <span class="fu">mean</span>(I.error2), <span class="fu">mean</span>(I.error3)))</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This sample comes from <span class="math inline">\(\alpha = \beta =
0, \gamma = 1\)</span>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TypeIError</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] 0.07 0.05 0.04</code></pre>
<p>This sample comes from <span class="math inline">\(\alpha = 0, \beta
= \gamma= 1\)</span>.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TypeIError</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] 0.06 0.87 0.70</code></pre>
<p>This sample comes from <span class="math inline">\(\beta = 0, \alpha
= \gamma = 1\)</span>.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TypeIError</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] 0.15 0.05 0.09</code></pre>
<p>We can see when <span class="math inline">\(\alpha = 0, \beta =
\gamma= 1\)</span>, the I-type-error tes of <span class="math inline">\(H_0:\beta = 0\)</span> and <span class="math inline">\(H_0:\alpha = 0 or \beta = 0\)</span> are lost of
control.</p>
</div>
<div id="question-20" class="section level2">
<h2>Question</h2>
<p>Classwork2.</p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>Expit <span class="ot">=</span> <span class="cf">function</span>(N, b1, b2, b3, f0)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  X1 <span class="ot">=</span> <span class="fu">rpois</span>(N, <span class="dv">1</span>)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  X2 <span class="ot">=</span> <span class="fu">rexp</span>(N, <span class="dv">1</span>)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  X3 <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), N, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">=</span> <span class="fu">length</span>(f0)</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">=</span> <span class="cf">function</span>(alpha)</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span> (alpha <span class="sc">+</span> b1 <span class="sc">*</span> X1 <span class="sc">+</span> b2 <span class="sc">*</span> X2 <span class="sc">+</span> b3 <span class="sc">*</span> X3)))</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">mean</span>(p) <span class="sc">-</span> f0[i])</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>    alpha[i] <span class="ot">=</span> <span class="fu">uniroot</span>(g, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">0</span>))<span class="sc">$</span>root</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(alpha)</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fu">Expit</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>, <span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>, <span class="dv">10</span><span class="sc">^-</span><span class="dv">4</span>))</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha)</span></code></pre></div>
<pre><code>[1]  -3.165269  -6.071346  -8.723370 -11.303179</code></pre>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> alpha, <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^-</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^-</span><span class="dv">2</span>, <span class="dv">10</span><span class="sc">^-</span><span class="dv">3</span>, <span class="dv">10</span><span class="sc">^-</span><span class="dv">4</span>), <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">ylab =</span> <span class="st">&quot;f0&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(alpha)</span></code></pre></div>
</div>
</div>
<div id="hw9-2022-11-11" class="section level1">
<h1>HW9-2022-11-11</h1>
<div id="question-21" class="section level2">
<h2>Question</h2>
<p>Classwork(2).</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<div id="section" class="section level4">
<h4>(2)</h4>
<p>We use the formula from the proof above.</p>
<p>MLE method:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>MLE <span class="ot">=</span> <span class="cf">function</span>(u, v)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  loglh <span class="ot">=</span> <span class="cf">function</span>(lambda)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="sc">-</span><span class="fu">sum</span>(u) <span class="sc">+</span> <span class="fu">sum</span>((v <span class="sc">-</span> u) <span class="sc">/</span> (<span class="fu">exp</span>(lambda <span class="sc">*</span> (v <span class="sc">-</span> u)) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">uniroot</span>(loglh, <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(v))))</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>EM method:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>EM <span class="ot">=</span> <span class="cf">function</span>(u, v, <span class="at">lambda0 =</span> <span class="dv">1</span>)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  iter <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  eps <span class="ot">=</span> <span class="dv">10</span> <span class="sc">^</span> <span class="sc">-</span><span class="dv">6</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  lambda.next <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">1</span>)</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">=</span> lambda0</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="dv">1</span>)</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>    iter <span class="ot">=</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>    lambda.next <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">/</span> lambda <span class="sc">+</span> <span class="fu">mean</span>(u) <span class="sc">-</span> <span class="fu">mean</span>((v <span class="sc">-</span> u) <span class="sc">/</span> (<span class="fu">exp</span>(lambda <span class="sc">*</span> (v <span class="sc">-</span> u)) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(lambda.next <span class="sc">-</span> lambda) <span class="sc">&lt;</span> eps)</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>    lambda <span class="ot">=</span>lambda.next</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">lambda.hat =</span> lambda.next, <span class="at">iteration =</span> iter))</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">27</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">0</span>, <span class="dv">23</span>, <span class="dv">10</span>, <span class="dv">24</span>, <span class="dv">2</span>)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">28</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">1</span>, <span class="dv">24</span>, <span class="dv">11</span>, <span class="dv">25</span>, <span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">MLE</span>(u, v)</span></code></pre></div>
<pre><code>$root
[1] 0.07197545

$f.root
[1] -0.003754871

$iter
[1] 13

$init.it
[1] NA

$estim.prec
[1] 6.678103e-05</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">EM</span>(u, v)</span></code></pre></div>
<pre><code>lambda.hat  iteration 
 0.0719735  3.0000000 </code></pre>
<p>We can see the two method give the same estimate,</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(u)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(v)</span></code></pre></div>
</div>
</div>
<div id="question-22" class="section level2">
<h2>Question</h2>
<p>(2.1.3, Ex 4, 5, Advanced in R)</p>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<div id="section-1" class="section level4">
<h4>4.</h4>
<p>Elements in a vector should be the same type, while a list doen not
demand that.So the as.vector() converts the elements into same type and
unlist() does not do that.</p>
</div>
<div id="section-2" class="section level4">
<h4>5.</h4>
<p>In 1 == “1”, the integer 1 is coerced to the character atomic vector
“1”, so the result is true.</p>
<p>In -1 &lt; FALSE , the logical atomic vector FALSE is coerced to the
integer 0, so the result is true.</p>
<p>In “one” &lt; 2 , the character atomic vector “one” cannot be coerced
to the integer 1, so it is false.</p>
</div>
</div>
<div id="question-23" class="section level2">
<h2>Question</h2>
<p>(2.3.1, Ex 1, 2, Advanced in R)</p>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<div id="section-3" class="section level4">
<h4>1.</h4>
<p>NULL. dim() is a function for matrix, data frame and array.</p>
</div>
<div id="section-4" class="section level4">
<h4>2.</h4>
<p>TRUE. A matrix is a kind of array.</p>
</div>
</div>
<div id="question-24" class="section level2">
<h2>Question</h2>
<p>(2.4.5, Ex 1, 2, 3, Advanced in R)</p>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<div id="section-5" class="section level4">
<h4>1.</h4>
<p>Names, row names, and class.</p>
</div>
<div id="section-6" class="section level4">
<h4>2.</h4>
<p>The elements in the data frame will be coerced into the same type and
follow the rule that: logical &lt; integer &lt; double &lt;
character.</p>
</div>
<div id="section-7" class="section level4">
<h4>3.</h4>
<p>A data frame with 0 row is permitted, but the one with 0 columns is
not permitted.</p>
</div>
</div>
</div>
<div id="hw10-2022-11" class="section level1">
<h1>HW10-2022-11</h1>
<div id="question-25" class="section level2">
<h2>Question</h2>
<p>(Ex11.1.2.2, Advanced R)</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<p>We use sapply() to apply the function to every column of a data
frame.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>dat11 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="fl">5.5</span>, <span class="dv">7</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>))</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dat11) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X2&quot;</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>dat11</span></code></pre></div>
<pre><code>  X1  X2
1  1 4.0
2  2 5.5
3  3 7.0</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dat11, scale01)</span></code></pre></div>
<pre><code>      X1  X2
[1,] 0.0 0.0
[2,] 0.5 0.5
[3,] 1.0 1.0</code></pre>
<p>If we need to select the numeric column, we can do it with the help
of dplyr::select_if().</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>dat12 <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), dat11, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>))</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dat12) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X2&quot;</span>, <span class="st">&quot;X3&quot;</span>, <span class="st">&quot;X4&quot;</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>dat12</span></code></pre></div>
<pre><code>  X1 X2  X3 X4
1  a  1 4.0  x
2  b  2 5.5  y
3  c  3 7.0  z</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dplyr<span class="sc">::</span><span class="fu">select_if</span>(dat12, is.numeric), scale01)</span></code></pre></div>
<pre><code>      X2  X3
[1,] 0.0 0.0
[2,] 0.5 0.5
[3,] 1.0 1.0</code></pre>
</div>
<div id="question-26" class="section level2">
<h2>Question</h2>
<p>(Ex11.2.5.1, Advanced R)</p>
</div>
<div id="answer-28" class="section level2">
<h2>Answer</h2>
<p>(We use data frames the same as the ones in the previous
question.)</p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(dat11, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code> X1  X2 
1.0 1.5 </code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(dat12[ ,<span class="fu">which</span>(<span class="fu">vapply</span>(dat12, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>)) <span class="sc">==</span> <span class="cn">TRUE</span>)], sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code> X2  X3 
1.0 1.5 </code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dat11)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dat12)</span></code></pre></div>
</div>
<div id="question-27" class="section level2">
<h2>Question</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain (Xt,
Yt) with zero means, unit standard deviations, and correlation 0.9.</p>
<p>• Write an Rcpp function.</p>
<p>• Compare the corresponding generated random numbers with pure R
language using the function “qqplot”.</p>
<p>• Compare the computation time of the two functions with the function
“microbenchmark”.</p>
</div>
<div id="answer-29" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix gibbsC(double inix, double iniy, double mu1, double mu2, double sigma1, double sigma2, double rho, int n = 10000, int burn = 1000){</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="st">NumericMatrix a(n+burn, 2);</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="st">double s1 = sqrt(1 - rho * rho) * sigma1, s2 = sqrt(1 - rho * rho) * sigma2 ;</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="st">a(0,0) = inix, a(0,1) = iniy;</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="st">for (int i = 1; i &lt;= n+burn-1; i++)</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a><span class="st">{</span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a><span class="st">  double tempy = a(i-1,1);</span></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a><span class="st">  double m1 = mu1 + rho * (tempy - mu2) * sigma1 / sigma2;</span></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a><span class="st">  a(i,0) = rnorm(1, m1, s1)[0];</span></span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a><span class="st">  double tempx = a(i,0);</span></span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a><span class="st">  double m2 = mu2 + rho * (tempx - mu1) * sigma2/sigma1;</span></span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a><span class="st">  a(i,1) = rnorm(1, m2, s2)[0];</span></span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a><span class="st">return (a);</span></span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">=</span> <span class="cf">function</span>(ini, mu1, mu2, sigma1, sigma2, rho, <span class="at">n =</span> <span class="dv">10000</span>, <span class="at">burn =</span> <span class="dv">1000</span>)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n <span class="sc">+</span> burn, <span class="dv">2</span>)</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">*</span> sigma1</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">*</span> sigma2</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>, ] <span class="ot">=</span> ini</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n <span class="sc">+</span> burn))</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">=</span> x[i <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">=</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>    x[i, <span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">=</span> x[i, <span class="dv">1</span>]</span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">=</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>    x[i, <span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fu">gibbsC</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.9</span>)[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>), ]</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>R <span class="ot">=</span> <span class="fu">gibbsR</span>(<span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">10</span>), <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.9</span>)[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>), ]</span></code></pre></div>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">sort</span>(C[,<span class="dv">1</span>]), <span class="fu">sort</span>(R[,<span class="dv">1</span>]), <span class="at">main=</span><span class="st">&quot;qqplot of x1&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;XC&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;XR&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">sort</span>(C[,<span class="dv">2</span>]), <span class="fu">sort</span>(R[,<span class="dv">2</span>]), <span class="at">main=</span><span class="st">&quot;qqplot of x2&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;XC&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;XR&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The two method gain similar result.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">=</span> microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(<span class="at">gibbC =</span> <span class="fu">gibbsC</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.9</span>), <span class="at">gibbR =</span> <span class="fu">gibbsR</span>(<span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">10</span>), <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.9</span>))</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>)]</span></code></pre></div>
<pre><code>   expr       lq   median       uq
1 gibbC  1.91405  2.00680  2.11645
2 gibbR 34.28285 36.37505 38.44330</code></pre>
<p>We see that much less time the Cpp method costs than the pure R code
costs.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(C)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(R)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
